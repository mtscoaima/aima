================================================================================
ë©”ì‹œì§€ ë°œì†¡ ê¸°ëŠ¥ êµ¬í˜„ ê³„íšì„œ - SMS/LMS/MMS ì „ìš© (2025-10-13 ì—…ë°ì´íŠ¸)
================================================================================
ì‘ì„±ì¼: 2025-10-13
ìµœì¢… ì—…ë°ì´íŠ¸: 2025-10-13 (ê¸°ì¡´ ë¦¬ì†ŒìŠ¤ ì¶”ê°€, ESLint ìˆ˜ì • ì™„ë£Œ)
ëŒ€ìƒ: messages/send í˜ì´ì§€ > ë©”ì‹œì§€ ë³´ë‚´ê¸° íƒ­ > ë¬¸ìë©”ì‹œì§€ í•˜ìœ„ íƒ­
ë²”ìœ„: SMS/LMS/MMS ë°œì†¡ ê¸°ëŠ¥ë§Œ í¬í•¨ (ì¹´ì¹´ì˜¤/RCS/ë„¤ì´ë²„ ì œì™¸)

âš ï¸âš ï¸âš ï¸ ì¤‘ìš” ê³µì§€ âš ï¸âš ï¸âš ï¸
================================================================================
ğŸš« UI ìˆ˜ì • ì ˆëŒ€ ê¸ˆì§€! ğŸš«
- ê¸°ì¡´ UI ì»´í¬ë„ŒíŠ¸ëŠ” ì ˆëŒ€ ìˆ˜ì •í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
- ìƒˆë¡œìš´ UI ìš”ì†Œë¥¼ ì¶”ê°€í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
- CSS ìŠ¤íƒ€ì¼ì„ ë³€ê²½í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
- ì»´í¬ë„ŒíŠ¸ êµ¬ì¡°ë¥¼ ë³€ê²½í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤

âœ… êµ¬í˜„ ê°€ëŠ¥í•œ ì‘ì—…:
- API ì—”ë“œí¬ì¸íŠ¸ ìƒì„± ë° ë¡œì§ êµ¬í˜„
- ê¸°ì¡´ UIì— API ì—°ë™ (state ë° handlerë§Œ)
- DB í…Œì´ë¸” ìƒì„± ë° ìŠ¤í‚¤ë§ˆ ê´€ë¦¬
- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶”ê°€

ğŸ“‹ êµ¬í˜„ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸:
[ ] ì´ ì‘ì—…ì´ UIë¥¼ ë³€ê²½í•˜ëŠ”ê°€? â†’ NOì—¬ì•¼ ì§„í–‰
[ ] ê¸°ì¡´ ì»´í¬ë„ŒíŠ¸ íŒŒì¼ì„ ìˆ˜ì •í•˜ëŠ”ê°€? â†’ ìµœì†Œí™”, API ì—°ë™ë§Œ
[ ] ìƒˆë¡œìš´ UI ìš”ì†Œë¥¼ ì¶”ê°€í•˜ëŠ”ê°€? â†’ ì ˆëŒ€ NO
================================================================================


================================================================================
ëª©ì°¨
================================================================================
1. í”„ë¡œì íŠ¸ ê°œìš” ë° í˜„í™©
2. ê¸°ì¡´ ë¦¬ì†ŒìŠ¤ ë¶„ì„ (ì¬ì‚¬ìš© ê°€ëŠ¥) â­ ì—…ë°ì´íŠ¸ë¨
3. êµ¬í˜„ ì „ëµ (ê³µí†µ ë¡œì§ ì¶”ì¶œ)
4. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
5. API ì—”ë“œí¬ì¸íŠ¸ ì„¤ê³„
6. ê³µí†µ ë¡œì§ êµ¬í˜„ (messageSender.ts)
7. ë‹¨ê³„ë³„ êµ¬í˜„ ê³„íš (7ì¼)
8. í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™ (API í˜¸ì¶œë§Œ)
9. í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
10. ë³´ì•ˆ ë° ì—ëŸ¬ ì²˜ë¦¬
11. ì¹˜í™˜ë¬¸êµ¬ í˜•ì‹ í†µì¼ ë°©ì•ˆ â­ ì‹ ê·œ ì¶”ê°€
12. ì—‘ì…€ ì—…ë¡œë“œ êµ¬í˜„ ê°€ì´ë“œ â­ ì‹ ê·œ ì¶”ê°€


================================================================================
1. í”„ë¡œì íŠ¸ ê°œìš” ë° í˜„í™©
================================================================================

1.1 ëŒ€ìƒ UI êµ¬ì¡°
-------------
messages/send í˜ì´ì§€
  â””â”€ MessageSendTab (ë©”ì‹œì§€ ë³´ë‚´ê¸° íƒ­)
      â”œâ”€ ì¢Œì¸¡ ì˜ì—­
      â”‚   â”œâ”€ ë©”ì‹œì§€ ë°œì‹ ë²ˆí˜¸ ì„ íƒ
      â”‚   â”œâ”€ ë©”ì‹œì§€ ìˆ˜ì‹ ë²ˆí˜¸ ì¶”ê°€ (ì§ì ‘ì…ë ¥/ì£¼ì†Œë¡/ì—‘ì…€/í…ìŠ¤íŠ¸)
      â”‚   â”œâ”€ ì¶”ê°€í•œ ìˆ˜ì‹ ë²ˆí˜¸ ëª©ë¡ (ì´ 0ê°œ)
      â”‚   â””â”€ ì €ì¥ ì„¹ì…˜ (ìƒˆë¡œ ì €ì¥/ë®ì–´ì“°ê¸°/ë¶ˆëŸ¬ì˜¤ê¸°)
      â”‚
      â””â”€ ìš°ì¸¡ ì˜ì—­
          â”œâ”€ 4ê°œ í•˜ìœ„ íƒ­ (ğŸ“±ë¬¸ìë©”ì‹œì§€/ğŸ’¬ì¹´ì¹´ì˜¤í†¡/ğŸ”µRCS/ğŸŸ¢ë„¤ì´ë²„í†¡í†¡)
          â”œâ”€ SmsMessageContent ì»´í¬ë„ŒíŠ¸ â† ì´ ë¶€ë¶„ë§Œ êµ¬í˜„!
          â”‚   â”œâ”€ ì œëª© (40ì, optional)
          â”‚   â”œâ”€ ë©”ì‹œì§€ ë‚´ìš© (2000 bytes)
          â”‚   â”œâ”€ ì´ë¯¸ì§€ ì²¨ë¶€ í† ê¸€ (MMS)
          â”‚   â”œâ”€ ì¹˜í™˜ë¬¸êµ¬ ë²„íŠ¼ (#[ë³€ìˆ˜ëª…] í˜•ì‹)
          â”‚   â””â”€ ë°œì†¡ ì˜µì…˜ (ê´‘ê³ ë©”ì‹œì§€ ì—¬ë¶€, ëŒ€ì²´ë°œì†¡ ì—¬ë¶€)
          â””â”€ ì „ì†¡/ì˜ˆì•½ ì¤€ë¹„ ë²„íŠ¼

1.2 í˜„ì¬ ìƒíƒœ (2025-10-13 ì—…ë°ì´íŠ¸)
-------------
âœ… UI ì™„ì„±: SmsMessageContent ì»´í¬ë„ŒíŠ¸ ì™„ì „ êµ¬í˜„
âœ… í™˜ê²½ë³€ìˆ˜: Naver SENS API ì„¤ì • ì™„ë£Œ
âœ… ê¸°ì¡´ êµ¬í˜„: reservations/message API ì™„ì „ ë™ì‘
âœ… ë°±ì—”ë“œ: messages/send API êµ¬í˜„ ì™„ë£Œ â­
âœ… ì—°ë™: ì¦‰ì‹œ ë°œì†¡ ê¸°ëŠ¥ ì™„ë£Œ â­
âœ… ESLint: TypeScript íƒ€ì… ì—ëŸ¬ ìˆ˜ì • ì™„ë£Œ â­
âŒ ì˜ˆì•½ ë°œì†¡: í”„ë¡ íŠ¸ì—”ë“œ UI ë¯¸êµ¬í˜„
âŒ í…œí”Œë¦¿ ê´€ë¦¬: API ì—°ë™ ë¯¸ì™„ë£Œ
âŒ ê³ ê¸‰ ê¸°ëŠ¥: ì—‘ì…€ ì—…ë¡œë“œ, ì£¼ì†Œë¡ ë“± ë¯¸êµ¬í˜„

1.3 êµ¬í˜„ ëª©í‘œ
------------
ë¬¸ìë©”ì‹œì§€ íƒ­ì—ì„œ ë‹¤ìŒ ê¸°ëŠ¥ì„ ì œê³µ:
- SMS/LMS/MMS ì¦‰ì‹œ ë° ì˜ˆì•½ ë°œì†¡
- ë°œì‹ ë²ˆí˜¸ ì„ íƒ ë° ê´€ë¦¬ (í˜„ì¬ í…ŒìŠ¤íŠ¸ ë²ˆí˜¸ë§Œ ì‚¬ìš©)
- ìˆ˜ì‹ ì ê´€ë¦¬ (ì§ì ‘ ì…ë ¥, ì£¼ì†Œë¡, ì—‘ì…€, í…ìŠ¤íŠ¸ íŒŒì¼)
- ë©”ì‹œì§€ í…œí”Œë¦¿ ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸°
- ì”ì•¡ í™•ì¸ ë° ë‹¨ê°€ ê³„ì‚°
- ì¹˜í™˜ë¬¸êµ¬ ì²˜ë¦¬ (#[ë³€ìˆ˜ëª…] í˜•ì‹)
- ê´‘ê³ ë©”ì‹œì§€ í‘œê¸° ìë™ ì²˜ë¦¬
- MMS ì´ë¯¸ì§€ ì—…ë¡œë“œ

ğŸš« UI ìˆ˜ì • ê¸ˆì§€: ê¸°ì¡´ UIëŠ” ê·¸ëŒ€ë¡œ ë‘ê³  ë°±ì—”ë“œë§Œ êµ¬í˜„!


================================================================================
2. ê¸°ì¡´ ë¦¬ì†ŒìŠ¤ ë¶„ì„ (ì¬ì‚¬ìš© ê°€ëŠ¥) â­ ì—…ë°ì´íŠ¸ë¨
================================================================================

2.1 ì´ë¯¸ ì‚¬ìš© ê°€ëŠ¥í•œ í™˜ê²½ë³€ìˆ˜
---------------------------
âœ… NEXT_PUBLIC_SUPABASE_URL
âœ… SUPABASE_SERVICE_ROLE_KEY
âœ… JWT_SECRET
âœ… NAVER_SENS_SERVICE_ID
âœ… NAVER_ACCESS_KEY_ID
âœ… NAVER_SECRET_KEY
âœ… TEST_CALLING_NUMBER

2.2 ê¸°ì¡´ DB í…Œì´ë¸” (í™œìš© ê°€ëŠ¥)
----------------------------
âœ… users - ì‚¬ìš©ì ì •ë³´
âœ… sender_numbers - ë°œì‹ ë²ˆí˜¸ ê´€ë¦¬
âœ… message_templates - ë©”ì‹œì§€ í…œí”Œë¦¿
âœ… transactions - ì”ì•¡ ê´€ë¦¬ (ì¶©ì „/ì‚¬ìš©)
âœ… reservation_message_templates - ì˜ˆì•½ ì‹œìŠ¤í…œ í…œí”Œë¦¿
âœ… reservation_scheduled_messages - ì˜ˆì•½ ë°œì†¡
âœ… reservation_message_logs - ë°œì†¡ ë‚´ì—­

2.3 ê¸°ì¡´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ìœ í‹¸ë¦¬í‹° â­ ì—…ë°ì´íŠ¸ë¨
--------------------------------------------

A. Naver SENS API ë˜í¼
----------------------
íŒŒì¼: src/lib/naverSensApi.ts

âœ… sendNaverSMS(toNumber, message, subject?, fromNumber?)
   - SMS/LMS ë°œì†¡
   - fromNumber íŒŒë¼ë¯¸í„° ì¶”ê°€ë¨ (2025-10-13)
   - ê¸°ë³¸ê°’: TEST_CALLING_NUMBER

âœ… sendNaverMMS(toNumber, message, subject, fileIds, fromNumber?)
   - MMS ë°œì†¡ (ì´ë¯¸ì§€ í¬í•¨)
   - fromNumber íŒŒë¼ë¯¸í„° ì¶”ê°€ë¨ (2025-10-13)
   - ê¸°ë³¸ê°’: TEST_CALLING_NUMBER


B. ë©”ì‹œì§€ í…œí”Œë¦¿ íŒŒì„œ ìœ í‹¸ë¦¬í‹°
-----------------------------
íŒŒì¼: src/utils/messageTemplateParser.ts

ì œê³µ í•¨ìˆ˜:
1. replaceTemplateVariables(template, reservation)
   - ë³€ìˆ˜ ì¹˜í™˜ ì²˜ë¦¬
   - í˜•ì‹: {{ë³€ìˆ˜ëª…}} (ì´ì¤‘ ì¤‘ê´„í˜¸)
   - ì§€ì› ë³€ìˆ˜: {{ê³ ê°ëª…}}, {{ê³µê°„ëª…}}, {{ì˜ˆì•½ë‚ ì§œ}}, {{ì²´í¬ì¸ì‹œê°„}},
                {{ì²´í¬ì•„ì›ƒì‹œê°„}}, {{ì¸ì›ìˆ˜}}, {{ì´ê¸ˆì•¡}}, {{ì…ê¸ˆì•¡}},
                {{ì”ê¸ˆ}}, {{ì „í™”ë²ˆí˜¸}}, {{íŠ¹ì´ì‚¬í•­}}

2. extractVariables(template)
   - í…œí”Œë¦¿ì—ì„œ ì‚¬ìš©ëœ ë³€ìˆ˜ ëª©ë¡ ì¶”ì¶œ
   - ë°˜í™˜: ["{{ê³ ê°ëª…}}", "{{ì˜ˆì•½ë‚ ì§œ}}"] í˜•ì‹

3. validateTemplate(template)
   - ì§€ì›í•˜ì§€ ì•ŠëŠ” ë³€ìˆ˜ ì²´í¬
   - ë°˜í™˜: { valid: boolean, invalidVariables: string[] }

4. calculateMessageBytes(message)
   - ë°”ì´íŠ¸ ìˆ˜ ê³„ì‚°
   - í•œê¸€: 3ë°”ì´íŠ¸, ASCII: 1ë°”ì´íŠ¸, 2ë°”ì´íŠ¸ ë¬¸ì: 2ë°”ì´íŠ¸

5. determineMessageType(message)
   - SMS/LMS ìë™ íŒë‹¨
   - 90ë°”ì´íŠ¸ ì´í•˜: SMS, 90ë°”ì´íŠ¸ ì´ˆê³¼: LMS

6. previewTemplate(template)
   - ìƒ˜í”Œ ë°ì´í„°ë¡œ ë¯¸ë¦¬ë³´ê¸° ìƒì„±
   - UIì—ì„œ í…œí”Œë¦¿ ì‘ì„± ì‹œ í™œìš©

âš ï¸ ì¤‘ìš” ì£¼ì˜ì‚¬í•­:
- í˜„ì¬ íŒŒì„œëŠ” {{ë³€ìˆ˜ëª…}} í˜•ì‹ë§Œ ì§€ì› (ì˜ˆì•½ ì‹œìŠ¤í…œìš©)
- messages/send APIëŠ” #[ë³€ìˆ˜ëª…] í˜•ì‹ ì‚¬ìš© ì¤‘
- í˜•ì‹ ë¶ˆì¼ì¹˜ ë¬¸ì œ â†’ 11ì¥ "ì¹˜í™˜ë¬¸êµ¬ í˜•ì‹ í†µì¼ ë°©ì•ˆ" ì°¸ê³ 

ì‚¬ìš© ì˜ˆì‹œ:
```typescript
import { determineMessageType, calculateMessageBytes } from '@/utils/messageTemplateParser';

const message = "ì•ˆë…•í•˜ì„¸ìš” ê³ ê°ë‹˜";
const bytes = calculateMessageBytes(message); // 24
const type = determineMessageType(message); // "SMS"
```


C. ì—‘ì…€ ì²˜ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬
----------------------
âœ… xlsx íŒ¨í‚¤ì§€ ì„¤ì¹˜ í™•ì¸ë¨ (node_modules)
   - ìš©ë„: ì—‘ì…€ íŒŒì¼ ì—…ë¡œë“œ ë° íŒŒì‹±
   - êµ¬í˜„ í•„ìš”: /api/contacts/import/excel API
   - ìƒì„¸ êµ¬í˜„ ë°©ë²•: 12ì¥ "ì—‘ì…€ ì—…ë¡œë“œ êµ¬í˜„ ê°€ì´ë“œ" ì°¸ê³ 

ì‚¬ìš© ì˜ˆì‹œ:
```typescript
import * as XLSX from 'xlsx';

// íŒŒì¼ ì½ê¸°
const workbook = XLSX.read(fileBuffer, { type: 'buffer' });
const sheetName = workbook.SheetNames[0];
const sheet = workbook.Sheets[sheetName];

// JSON ë³€í™˜
const data = XLSX.utils.sheet_to_json(sheet);
```


D. ê³µí†µ ë©”ì‹œì§€ ë°œì†¡ ë¡œì§
-----------------------
íŒŒì¼: src/lib/messageSender.ts (2025-10-13 ìƒì„±ë¨)

âœ… sendMessage(params: SendMessageParams)
   - ì¦‰ì‹œ ë°œì†¡ ì²˜ë¦¬
   - ì”ì•¡ í™•ì¸ â†’ ë°œì†¡ â†’ ì°¨ê° ìˆœì„œ
   - fromNumber íŒŒë¼ë¯¸í„° ì§€ì›

âœ… scheduleMessage(params: ScheduleMessageParams, tableName)
   - ì˜ˆì•½ ë°œì†¡ ì²˜ë¦¬
   - ë‹¤ì¤‘ í…Œì´ë¸” ì§€ì› (scheduled_messages, reservation_scheduled_messages)

âœ… checkBalance(userId)
   - ê´‘ê³ ë¨¸ë‹ˆ ì”ì•¡ ì¡°íšŒ

âœ… deductBalance(userId, amount, messageType, metadata)
   - ì”ì•¡ ì°¨ê° ë° íŠ¸ëœì­ì…˜ ê¸°ë¡


2.4 ê¸°ì¡´ API êµ¬í˜„ (reservations)
------------------------------
âœ… src/app/api/reservations/send-message/route.ts
   - ì¦‰ì‹œ/ì˜ˆì•½ ë°œì†¡
   - ì”ì•¡ í™•ì¸/ì°¨ê°
   - JWT ì¸ì¦
   - ë³€ìˆ˜ ì¹˜í™˜ ({{ë³€ìˆ˜ëª…}} í˜•ì‹)
   - ê³µí†µ ë¡œì§ ì‚¬ìš©í•˜ë„ë¡ ë¦¬íŒ©í† ë§ ì™„ë£Œ (2025-10-13)

âœ… src/app/api/reservations/scheduled-messages/route.ts
   - ì˜ˆì•½ ë©”ì‹œì§€ ëª©ë¡ ì¡°íšŒ
   - ì˜ˆì•½ ë©”ì‹œì§€ ì·¨ì†Œ

âœ… src/app/api/reservations/message-templates/route.ts
   - í…œí”Œë¦¿ CRUD

ì°¸ê³ ìš© ì½”ë“œ ìœ„ì¹˜:
- ì¹˜í™˜ ë¡œì§ ì˜ˆì‹œ: src/app/api/reservations/send-message/route.ts
- UI ì˜ˆì‹œ: src/app/reservations/message/templates/page.tsx


================================================================================
3. êµ¬í˜„ ì „ëµ (ê³µí†µ ë¡œì§ ì¶”ì¶œ) â­â­â­
================================================================================

3.1 ì™œ ê³µí†µ ë¡œì§ ì¶”ì¶œì¸ê°€?
------------------------
âŒ ë°©ì•ˆ A: ê¸°ì¡´ API ì§ì ‘ í˜¸ì¶œ
   - reservation_id í•„ìˆ˜ (ì˜ˆì•½ ì‹œìŠ¤í…œ ì˜ì¡´)

âŒ ë°©ì•ˆ B: ì½”ë“œ ë³µì‚¬í•˜ì—¬ ìƒˆ API ìƒì„±
   - ì½”ë“œ ì¤‘ë³µ
   - ìœ ì§€ë³´ìˆ˜ ë¶€ë‹´

âœ… ë°©ì•ˆ C: ê³µí†µ ë¡œì§ ì¶”ì¶œ (ì„ íƒ!) â† ì™„ë£Œë¨
   - ì½”ë“œ ì¬ì‚¬ìš©
   - ë…ë¦½ì ì¸ API
   - ìœ ì§€ë³´ìˆ˜ ìš©ì´

3.2 êµ¬í˜„ êµ¬ì¡°
------------
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ê¸°ì¡´: reservations/send-message API    â”‚
â”‚  ì‹ ê·œ: messages/send API                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ê³µí†µ ë¡œì§: src/lib/messageSender.ts    â”‚
â”‚  - sendMessage()                        â”‚
â”‚  - scheduleMessage()                    â”‚
â”‚  - checkBalance()                       â”‚
â”‚  - deductBalance()                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì™¸ë¶€ API: Naver SENS                   â”‚
â”‚  DB: Supabase (transactions ë“±)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


================================================================================
4. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ
================================================================================

4.1 ê¸°ì¡´ í…Œì´ë¸” (ìˆ˜ì • ì—†ìŒ)
-------------------------
âœ… sender_numbers - ë°œì‹ ë²ˆí˜¸
âœ… message_templates - í…œí”Œë¦¿
âœ… transactions - ì”ì•¡ ê´€ë¦¬
âœ… users - ì‚¬ìš©ì ì •ë³´

4.2 ì‹ ê·œ í…Œì´ë¸” (ìƒì„± í•„ìš”)
-------------------------

ğŸ“Œ scheduled_messages (messages/send ì „ìš© ì˜ˆì•½ ë°œì†¡)
----------------------------------------------------
CREATE TABLE scheduled_messages (
  id SERIAL PRIMARY KEY,
  user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  to_number VARCHAR(20) NOT NULL,
  to_name VARCHAR(100),
  message_content TEXT NOT NULL,
  subject VARCHAR(100),
  scheduled_at TIMESTAMP NOT NULL,
  status VARCHAR(20) DEFAULT 'pending', -- 'pending', 'sent', 'failed', 'cancelled'
  sent_at TIMESTAMP,
  error_message TEXT,
  metadata JSONB, -- ì¶”ê°€ ì •ë³´ (source: 'sms_tab', message_type: 'SMS' ë“±)
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_scheduled_messages_user_id ON scheduled_messages(user_id);
CREATE INDEX idx_scheduled_messages_status ON scheduled_messages(status);
CREATE INDEX idx_scheduled_messages_scheduled_at ON scheduled_messages(scheduled_at);


ğŸ“Œ message_logs (ë°œì†¡ ë‚´ì—­) - Optional
-------------------------------------
CREATE TABLE message_logs (
  id SERIAL PRIMARY KEY,
  user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  to_number VARCHAR(20) NOT NULL,
  to_name VARCHAR(100),
  message_content TEXT NOT NULL,
  subject VARCHAR(100),
  message_type VARCHAR(10) NOT NULL, -- 'SMS', 'LMS', 'MMS'
  sent_at TIMESTAMP,
  status VARCHAR(20) NOT NULL, -- 'sent', 'failed'
  error_message TEXT,
  credit_used INTEGER,
  metadata JSONB,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_message_logs_user_id ON message_logs(user_id);
CREATE INDEX idx_message_logs_sent_at ON message_logs(sent_at);


ğŸ“Œ contacts (ì£¼ì†Œë¡) - Optional
--------------------------------
CREATE TABLE contacts (
  id SERIAL PRIMARY KEY,
  user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  name VARCHAR(100),
  phone_number VARCHAR(20) NOT NULL,
  group_name VARCHAR(100),
  variables JSONB, -- ì¹˜í™˜ ë³€ìˆ˜ {"ì´ë¦„": "í™ê¸¸ë™", "íšŒì‚¬": "ABC"}
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_contacts_user_id ON contacts(user_id);
CREATE INDEX idx_contacts_group_name ON contacts(group_name);


ğŸ“Œ recipient_groups (ìˆ˜ì‹ ì ê·¸ë£¹ ì €ì¥) - Optional
-------------------------------------------------
CREATE TABLE recipient_groups (
  id SERIAL PRIMARY KEY,
  user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
  name VARCHAR(100) NOT NULL,
  recipients JSONB NOT NULL,
  created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_recipient_groups_user_id ON recipient_groups(user_id);


================================================================================
5. API ì—”ë“œí¬ì¸íŠ¸ ì„¤ê³„
================================================================================

5.1 ì¦‰ì‹œ êµ¬í˜„ (Phase 1)
----------------------

ğŸ“ POST /api/messages/send âœ… êµ¬í˜„ ì™„ë£Œ
- ì¦‰ì‹œ ë°œì†¡ ë° ì˜ˆì•½ ë°œì†¡
- ë‹¤ì¤‘ ìˆ˜ì‹ ì ì§€ì›
- ì¹˜í™˜ë¬¸êµ¬ ì²˜ë¦¬ (#[ë³€ìˆ˜ëª…] í˜•ì‹)

ìš”ì²­:
{
  "recipients": [
    {
      "phone_number": "01012345678",
      "name": "í™ê¸¸ë™",
      "variables": {"ì´ë¦„": "í™ê¸¸ë™", "ì‹œê°„": "14:00"}
    }
  ],
  "message": "ì•ˆë…•í•˜ì„¸ìš” #[ì´ë¦„]ë‹˜",
  "subject": "ì œëª© (optional)",
  "sendType": "immediate", // 'immediate' | 'scheduled'
  "scheduledAt": "2025-10-15T14:00:00+09:00", // sendTypeì´ 'scheduled'ì¸ ê²½ìš°
  "isAd": false // ê´‘ê³  ë©”ì‹œì§€ ì—¬ë¶€
}

ì‘ë‹µ (ì¦‰ì‹œ ë°œì†¡):
{
  "success": true,
  "totalCount": 1,
  "successCount": 1,
  "failCount": 0,
  "results": [
    {
      "recipient": "01012345678",
      "success": true,
      "messageId": "req-id-123",
      "messageType": "SMS",
      "creditUsed": 20
    }
  ]
}

ì‘ë‹µ (ì˜ˆì•½ ë°œì†¡):
{
  "success": true,
  "scheduledCount": 1,
  "scheduledAt": "2025-10-15T14:00:00+09:00",
  "results": [...]
}


ğŸ“ GET /api/messages/scheduled âŒ ë¯¸êµ¬í˜„
- ì˜ˆì•½ ë©”ì‹œì§€ ëª©ë¡ ì¡°íšŒ

ì‘ë‹µ:
{
  "messages": [
    {
      "id": 1,
      "to_number": "01012345678",
      "to_name": "í™ê¸¸ë™",
      "message_content": "...",
      "scheduled_at": "2025-10-15T14:00:00+09:00",
      "status": "pending",
      "created_at": "..."
    }
  ]
}


ğŸ“ DELETE /api/messages/scheduled?id=123 âŒ ë¯¸êµ¬í˜„
- ì˜ˆì•½ ë©”ì‹œì§€ ì·¨ì†Œ

ì‘ë‹µ:
{
  "success": true
}


ğŸ“ GET /api/sender-numbers âŒ ë¯¸êµ¬í˜„
- ë°œì‹ ë²ˆí˜¸ ëª©ë¡ ì¡°íšŒ

ì‘ë‹µ:
{
  "data": [
    {
      "id": 1,
      "phone_number": "01012345678",
      "display_name": "í™ê¸¸ë™",
      "is_default": true,
      "is_verified": true,
      "status": "ACTIVE"
    }
  ]
}


ğŸ“ POST /api/sender-numbers âŒ ë¯¸êµ¬í˜„
- ë°œì‹ ë²ˆí˜¸ ë“±ë¡

ìš”ì²­:
{
  "phone_number": "01012345678",
  "display_name": "í™ê¸¸ë™"
}


ğŸ“ PUT /api/sender-numbers/:id/default âŒ ë¯¸êµ¬í˜„
- ê¸°ë³¸ ë°œì‹ ë²ˆí˜¸ ì„¤ì •


ğŸ“ GET /api/message-templates âŒ ë¯¸êµ¬í˜„
- í…œí”Œë¦¿ ëª©ë¡ ì¡°íšŒ

ğŸ“ POST /api/message-templates âŒ ë¯¸êµ¬í˜„
- í…œí”Œë¦¿ ì €ì¥

ğŸ“ PUT /api/message-templates/:id âŒ ë¯¸êµ¬í˜„
- í…œí”Œë¦¿ ìˆ˜ì •

ğŸ“ DELETE /api/message-templates/:id âŒ ë¯¸êµ¬í˜„
- í…œí”Œë¦¿ ì‚­ì œ


5.2 ì¶”í›„ êµ¬í˜„ (Phase 2+)
-----------------------
- POST /api/contacts - ì£¼ì†Œë¡ ê´€ë¦¬
- POST /api/contacts/import/excel - ì—‘ì…€ ì—…ë¡œë“œ (12ì¥ ì°¸ê³ )
- POST /api/upload/message-image - MMS ì´ë¯¸ì§€ ì—…ë¡œë“œ
- GET /api/message-logs - ìµœê·¼ ë°œì†¡ ë‚´ì—­


================================================================================
6. ê³µí†µ ë¡œì§ êµ¬í˜„ (messageSender.ts) âœ… ì™„ë£Œ
================================================================================

íŒŒì¼: src/lib/messageSender.ts (2025-10-13 ìƒì„± ì™„ë£Œ)

ì£¼ìš” ì¸í„°í˜ì´ìŠ¤:
```typescript
export interface SendMessageParams {
  userId: number;
  fromNumber?: string; // ë°œì‹ ë²ˆí˜¸ (optional, ê¸°ë³¸ê°’: TEST_CALLING_NUMBER)
  toNumber: string;
  toName?: string;
  message: string;
  subject?: string;
  messageType?: 'SMS' | 'LMS' | 'MMS';
  imageFileIds?: string[]; // MMS ì´ë¯¸ì§€
  metadata?: Record<string, any>;
}

export interface ScheduleMessageParams {
  userId: number;
  fromNumber?: string;
  toNumber: string;
  toName?: string;
  message: string;
  subject?: string;
  scheduledAt: string;
  metadata?: Record<string, any>;
}
```

ì£¼ìš” í•¨ìˆ˜:
1. sendMessage() - ì¦‰ì‹œ ë°œì†¡
2. scheduleMessage() - ì˜ˆì•½ ë°œì†¡
3. checkBalance() - ì”ì•¡ í™•ì¸
4. deductBalance() - ì”ì•¡ ì°¨ê°

ìì„¸í•œ ì½”ë“œëŠ” src/lib/messageSender.ts ì°¸ê³ 


================================================================================
7. ë‹¨ê³„ë³„ êµ¬í˜„ ê³„íš (7ì¼) â­ ì—…ë°ì´íŠ¸ë¨
================================================================================

ğŸš« ì£¼ì˜: ëª¨ë“  ë‹¨ê³„ì—ì„œ UI ìˆ˜ì • ê¸ˆì§€! API ì—°ë™ë§Œ ì§„í–‰!

Day 1: ê³µí†µ ë¡œì§ ë° DB ì¤€ë¹„ âœ… ì™„ë£Œ
--------------------------
[âœ…] src/lib/messageSender.ts ìƒì„± ë° êµ¬í˜„
[âœ…] naverSensApi.tsì— fromNumber íŒŒë¼ë¯¸í„° ì¶”ê°€
[âœ…] reservations API ë¦¬íŒ©í† ë§ (ê³µí†µ ë¡œì§ ì‚¬ìš©)
[ ] DB ë§ˆì´ê·¸ë ˆì´ì…˜ ì‘ì„±
    - scheduled_messages í…Œì´ë¸” ìƒì„±
    - message_logs í…Œì´ë¸” ìƒì„± (optional)


Day 2: ë©”ì‹œì§€ ë°œì†¡ API êµ¬í˜„ âœ… ì™„ë£Œ
--------------------------
[âœ…] src/app/api/messages/send/route.ts ìƒì„±
[âœ…] POST í•¸ë“¤ëŸ¬ êµ¬í˜„
[âœ…] JWT ì¸ì¦ í†µí•©
[âœ…] ë‹¤ì¤‘ ìˆ˜ì‹ ì ì²˜ë¦¬
[âœ…] ì¹˜í™˜ë¬¸êµ¬ ì²˜ë¦¬ (#[ë³€ìˆ˜ëª…] í˜•ì‹)
[âœ…] ì¦‰ì‹œ/ì˜ˆì•½ ë°œì†¡ ë¶„ê¸°
[âœ…] ê´‘ê³  ë©”ì‹œì§€ ìë™ í‘œê¸°
[âœ…] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì™„ë£Œ


Day 3: ì˜ˆì•½ ë©”ì‹œì§€ ê´€ë¦¬ API êµ¬í˜„ âŒ ë¯¸êµ¬í˜„
-------------------------------
[ ] src/app/api/messages/scheduled/route.ts ìƒì„±
    - GET: ì˜ˆì•½ ë©”ì‹œì§€ ëª©ë¡ ì¡°íšŒ
    - DELETE: ì˜ˆì•½ ë©”ì‹œì§€ ì·¨ì†Œ
[ ] ì˜ˆì•½ ë°œì†¡ ìŠ¤ì¼€ì¤„ëŸ¬ ì„¤ê³„
    - Supabase Edge Function ë˜ëŠ” Cron Job
[ ] í…ŒìŠ¤íŠ¸


Day 4: ë°œì‹ ë²ˆí˜¸ ê´€ë¦¬ API êµ¬í˜„ â¸ï¸ ë³´ë¥˜
---------------------------
[ ] src/app/api/sender-numbers/route.ts ìƒì„±
    - GET: ë°œì‹ ë²ˆí˜¸ ëª©ë¡ ì¡°íšŒ
    - POST: ë°œì‹ ë²ˆí˜¸ ë“±ë¡
[ ] src/app/api/sender-numbers/[id]/default/route.ts
    - PUT: ê¸°ë³¸ê°’ ì„¤ì •
[ ] í…ŒìŠ¤íŠ¸

âš ï¸ í˜„ì¬ í…ŒìŠ¤íŠ¸ ë²ˆí˜¸ë§Œ ì‚¬ìš© ì¤‘, ì¶”í›„ êµ¬í˜„ ì˜ˆì •


Day 5: ë©”ì‹œì§€ í…œí”Œë¦¿ API âŒ ë¯¸êµ¬í˜„
----------------------------------------
[ ] ê¸°ì¡´ API í™œìš© ê°€ëŠ¥ì„± ê²€í† 
    - message_templates í…Œì´ë¸” í™œìš©
[ ] í•„ìš”ì‹œ ì‹ ê·œ API êµ¬í˜„
    - GET /api/message-templates
    - POST /api/message-templates
    - PUT /api/message-templates/:id
    - DELETE /api/message-templates/:id
[ ] í…ŒìŠ¤íŠ¸


Day 6: í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™ (ğŸš« UI ìˆ˜ì • ê¸ˆì§€!) âš ï¸ ë¶€ë¶„ ì™„ë£Œ
----------------------------------------
[âœ…] MessageSendTab.tsx - ê¸°ë³¸ ìƒíƒœ ì¶”ê°€
    - selectedSenderNumber ìƒíƒœ
    - recipients ìƒíƒœ
    - messageData ìƒíƒœ
[âœ…] ìˆ˜ì‹ ë²ˆí˜¸ ì§ì ‘ ì…ë ¥ ê¸°ëŠ¥
    - handleAddRecipient() êµ¬í˜„
    - ì „í™”ë²ˆí˜¸ í˜•ì‹ ê²€ì¦
[âœ…] ì¦‰ì‹œ ë°œì†¡ ê¸°ëŠ¥
    - handleImmediateSend() êµ¬í˜„
    - API í˜¸ì¶œ ë° ì—ëŸ¬ ì²˜ë¦¬
[âœ…] ESLint ì—ëŸ¬ ìˆ˜ì •
    - TypeScript any íƒ€ì… ì œê±°
    - ëª…ì‹œì  íƒ€ì… ì§€ì •

[ ] ì˜ˆì•½ ë°œì†¡ UI
    - ScheduleModal ìƒì„± í•„ìš”
    - handleScheduledSend() êµ¬í˜„

[ ] SenderNumberSelectModal.tsx
    - fetchSenderNumbers() API í˜¸ì¶œ ì¶”ê°€ (ë³´ë¥˜)

[ ] SaveContentModal.tsx
    - handleSave() API í˜¸ì¶œ ì¶”ê°€

[ ] LoadContentModal.tsx
    - fetchTemplates() API í˜¸ì¶œ ì¶”ê°€

âš ï¸ ì£¼ì˜: ì»´í¬ë„ŒíŠ¸ JSX êµ¬ì¡°ëŠ” ì ˆëŒ€ ìˆ˜ì •í•˜ì§€ ë§ ê²ƒ!
         useState, useEffect, handler í•¨ìˆ˜ë§Œ ì¶”ê°€!


Day 7: í†µí•© í…ŒìŠ¤íŠ¸ ë° ë²„ê·¸ ìˆ˜ì • âš ï¸ ì§„í–‰ ì¤‘
-----------------------------
[âœ…] ì¦‰ì‹œ ë°œì†¡ í…ŒìŠ¤íŠ¸
[âœ…] ì”ì•¡ ì°¨ê° í™•ì¸
[âœ…] JWT ì¸ì¦ í™•ì¸
[ ] ì˜ˆì•½ ë°œì†¡ í…ŒìŠ¤íŠ¸
[ ] í…œí”Œë¦¿ ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸°
[ ] ì—ëŸ¬ ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸


================================================================================
8. í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™ (API í˜¸ì¶œë§Œ, ğŸš« UI ìˆ˜ì • ê¸ˆì§€!) âš ï¸ ì—…ë°ì´íŠ¸ë¨
================================================================================

8.1 MessageSendTab.tsx ì—°ë™ âœ… ë¶€ë¶„ ì™„ë£Œ
---------------------------

í˜„ì¬ êµ¬í˜„ëœ ê¸°ëŠ¥:
- ë°œì‹ ë²ˆí˜¸ ìƒíƒœ ê´€ë¦¬ (selectedSenderNumber)
- ìˆ˜ì‹ ë²ˆí˜¸ ë°°ì—´ ê´€ë¦¬ (recipients)
- ë©”ì‹œì§€ ë°ì´í„° ê´€ë¦¬ (messageData)
- ìˆ˜ì‹ ë²ˆí˜¸ ì§ì ‘ ì¶”ê°€ (handleAddRecipient)
- ì¦‰ì‹œ ì „ì†¡ (handleImmediateSend)
- ë¡œë”©/ì—ëŸ¬ ìƒíƒœ ê´€ë¦¬

ìœ„ì¹˜: src/components/messages/MessageSendTab.tsx (46-198ì¤„)

```typescript
// ìƒíƒœ ê´€ë¦¬
const [selectedSenderNumber, setSelectedSenderNumber] = useState<string>("");
const [recipients, setRecipients] = useState<Recipient[]>([]);
const [messageData, setMessageData] = useState<MessageData>({
  subject: "",
  content: "",
  isAd: false
});
const [isLoading, setIsLoading] = useState(false);
const [error, setError] = useState<string | null>(null);

// ìˆ˜ì‹ ë²ˆí˜¸ ì¶”ê°€
const handleAddRecipient = () => {
  const trimmed = recipientInput.trim();
  if (!trimmed) return;

  const phoneNumber = trimmed.replace(/-/g, "");
  if (!/^01[0-9]{8,9}$/.test(phoneNumber)) {
    setError("ì˜¬ë°”ë¥¸ ì „í™”ë²ˆí˜¸ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤");
    return;
  }

  if (recipients.some(r => r.phone_number === phoneNumber)) {
    setError("ì´ë¯¸ ì¶”ê°€ëœ ë²ˆí˜¸ì…ë‹ˆë‹¤");
    return;
  }

  setRecipients([...recipients, { phone_number: phoneNumber }]);
  setRecipientInput("");
  setError(null);
};

// ì¦‰ì‹œ ì „ì†¡
const handleImmediateSend = async () => {
  setIsLoading(true);
  setError(null);

  try {
    const token = localStorage.getItem("access_token");
    if (!token) {
      throw new Error("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤");
    }

    const response = await fetch("/api/messages/send", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${token}`
      },
      body: JSON.stringify({
        from_number: selectedSenderNumber,
        recipients: recipients,
        message: messageData.content,
        subject: messageData.subject || undefined,
        sendType: "immediate",
        isAd: messageData.isAd
      })
    });

    const data = await response.json();

    if (!response.ok) {
      throw new Error(data.error || "ë©”ì‹œì§€ ì „ì†¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤");
    }

    const successCount = data.results.filter((r: { success: boolean }) => r.success).length;
    const failCount = data.results.filter((r: { success: boolean }) => !r.success).length;
    alert(`ë©”ì‹œì§€ ì „ì†¡ ì™„ë£Œ\nì„±ê³µ: ${successCount}ê±´\nì‹¤íŒ¨: ${failCount}ê±´`);

    setRecipients([]);

  } catch (err) {
    const errorMessage = err instanceof Error ? err.message : "ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";
    setError(errorMessage);
    alert(`ì „ì†¡ ì‹¤íŒ¨: ${errorMessage}`);
  } finally {
    setIsLoading(false);
  }
};
```

ë¯¸êµ¬í˜„ ê¸°ëŠ¥:
- handleScheduledSend() - ì˜ˆì•½ ì „ì†¡
- handleLoadTemplate() - í…œí”Œë¦¿ ë¶ˆëŸ¬ì˜¤ê¸°
- handleSaveTemplate() - í…œí”Œë¦¿ ì €ì¥


8.2 SenderNumberSelectModal.tsx ì—°ë™ â¸ï¸ ë³´ë¥˜
-----------------------------------

í˜„ì¬ ìƒíƒœ:
- ë°œì‹ ë²ˆí˜¸ ì„ íƒ ë²„íŠ¼ í´ë¦­ ì‹œ "ê°œë°œ ì¤‘ì…ë‹ˆë‹¤" ì•Œë¦¼ í‘œì‹œ
- í…ŒìŠ¤íŠ¸ ë°œì‹ ë²ˆí˜¸ë¡œ ìë™ ì „ì†¡
- ì¶”í›„ êµ¬í˜„ ì˜ˆì •


8.3 SaveContentModal.tsx ì—°ë™ âŒ ë¯¸êµ¬í˜„
----------------------------------

í•„ìš” ì‘ì—…:
```typescript
const handleSave = async () => {
  if (!templateName || !currentContent) {
    alert('í…œí”Œë¦¿ ì´ë¦„ê³¼ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.');
    return;
  }

  try {
    const response = await fetch('/api/message-templates', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${getToken()}`
      },
      body: JSON.stringify({
        name: templateName,
        content: currentContent,
        category: 'ê¸°íƒ€'
      })
    });

    if (response.ok) {
      alert('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
      onClose();
    } else {
      const { error } = await response.json();
      alert(`ì €ì¥ ì‹¤íŒ¨: ${error}`);
    }
  } catch (error) {
    console.error('ì €ì¥ ì˜¤ë¥˜:', error);
    alert('ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
  }
};
```


8.4 LoadContentModal.tsx ì—°ë™ âŒ ë¯¸êµ¬í˜„
-----------------------------------

í•„ìš” ì‘ì—…:
```typescript
const [templates, setTemplates] = useState([]);
const [loading, setLoading] = useState(false);

useEffect(() => {
  if (isOpen && activeTab === 'saved') {
    fetchTemplates();
  }
}, [isOpen, activeTab]);

const fetchTemplates = async () => {
  setLoading(true);
  try {
    const response = await fetch('/api/message-templates', {
      headers: {
        'Authorization': `Bearer ${getToken()}`
      }
    });

    const { data } = await response.json();
    setTemplates(data || []);
  } catch (error) {
    console.error('í…œí”Œë¦¿ ì¡°íšŒ ì‹¤íŒ¨:', error);
  } finally {
    setLoading(false);
  }
};

const handleSelect = (template) => {
  onSelect({
    subject: template.subject,
    content: template.content,
    isAd: false
  });
  onClose();
};
```


================================================================================
9. í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
================================================================================

9.1 API ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (Postman/Thunder Client)
-------------------------------------------

âœ… POST /api/messages/send (ì¦‰ì‹œ ë°œì†¡) - ì™„ë£Œ
ìš”ì²­:
```json
{
  "recipients": [{"phone_number": "01012345678"}],
  "message": "í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€",
  "sendType": "immediate"
}
```
ì˜ˆìƒ ê²°ê³¼: 200 OK, successCount: 1

âœ… POST /api/messages/send (ì˜ˆì•½ ë°œì†¡) - ì™„ë£Œ
ìš”ì²­:
```json
{
  "recipients": [{"phone_number": "01012345678"}],
  "message": "í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€",
  "sendType": "scheduled",
  "scheduledAt": "2025-10-15T14:00:00+09:00"
}
```
ì˜ˆìƒ ê²°ê³¼: 200 OK, scheduledCount: 1

âŒ GET /api/messages/scheduled - ë¯¸êµ¬í˜„
ì˜ˆìƒ ê²°ê³¼: 200 OK, messages ë°°ì—´ ë°˜í™˜

âŒ GET /api/sender-numbers - ë¯¸êµ¬í˜„
ì˜ˆìƒ ê²°ê³¼: 200 OK, data ë°°ì—´ ë°˜í™˜

âŒ POST /api/message-templates - ë¯¸êµ¬í˜„
ìš”ì²­:
```json
{
  "name": "í…ŒìŠ¤íŠ¸ í…œí”Œë¦¿",
  "content": "ì•ˆë…•í•˜ì„¸ìš”"
}
```
ì˜ˆìƒ ê²°ê³¼: 201 Created


9.2 í†µí•© í…ŒìŠ¤íŠ¸ (UIì—ì„œ)
-----------------------
ğŸš« ì£¼ì˜: UI ìˆ˜ì • ì—†ì´ ê¸°ëŠ¥ë§Œ í…ŒìŠ¤íŠ¸!

1. ë°œì‹ ë²ˆí˜¸ ì„ íƒ â¸ï¸ ë³´ë¥˜
   [ ] ë°œì‹ ë²ˆí˜¸ ëª©ë¡ì´ í‘œì‹œë˜ëŠ”ê°€?
   [ ] ì„ íƒ ì‹œ ìƒíƒœê°€ ì—…ë°ì´íŠ¸ë˜ëŠ”ê°€?

2. ìˆ˜ì‹ ë²ˆí˜¸ ì¶”ê°€ âœ… ì™„ë£Œ
   [âœ…] ì „í™”ë²ˆí˜¸ ì…ë ¥ í›„ ì¶”ê°€ ë²„íŠ¼ í´ë¦­
   [âœ…] ëª©ë¡ì— ì¶”ê°€ë˜ëŠ”ê°€?
   [âœ…] ì˜ëª»ëœ ë²ˆí˜¸ ì…ë ¥ ì‹œ ì—ëŸ¬ ë©”ì‹œì§€?

3. ë©”ì‹œì§€ ì‘ì„± âœ… ì™„ë£Œ
   [âœ…] ë‚´ìš© ì…ë ¥ ì‹œ ìƒíƒœ ì—…ë°ì´íŠ¸?
   [âœ…] ê¸€ì ìˆ˜ ì¹´ìš´íŠ¸ ë™ì‘?

4. ì¦‰ì‹œ ë°œì†¡ âœ… ì™„ë£Œ
   [âœ…] ë°œì†¡ ë²„íŠ¼ í´ë¦­
   [âœ…] í™•ì¸ ë‹¤ì´ì–¼ë¡œê·¸ í‘œì‹œ?
   [âœ…] ë°œì†¡ ì™„ë£Œ ë©”ì‹œì§€?
   [âœ…] ì”ì•¡ ì°¨ê° í™•ì¸?

5. í…œí”Œë¦¿ ì €ì¥ âŒ ë¯¸êµ¬í˜„
   [ ] ì €ì¥ ëª¨ë‹¬ ì—´ë¦¼?
   [ ] í…œí”Œë¦¿ ì´ë¦„ ì…ë ¥ í›„ ì €ì¥?
   [ ] ì €ì¥ ì™„ë£Œ ë©”ì‹œì§€?

6. í…œí”Œë¦¿ ë¶ˆëŸ¬ì˜¤ê¸° âŒ ë¯¸êµ¬í˜„
   [ ] ë¶ˆëŸ¬ì˜¤ê¸° ëª¨ë‹¬ ì—´ë¦¼?
   [ ] í…œí”Œë¦¿ ëª©ë¡ í‘œì‹œ?
   [ ] ì„ íƒ ì‹œ ë‚´ìš© ë³µì›?


9.3 ì—ëŸ¬ ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸
---------------------
[âœ…] ì”ì•¡ ë¶€ì¡± ì‹œ ë°œì†¡ ì°¨ë‹¨
[âœ…] ì˜ëª»ëœ ì „í™”ë²ˆí˜¸ ì…ë ¥ ì‹œ ì—ëŸ¬
[âœ…] JWT í† í° ë§Œë£Œ ì‹œ 401 ì—ëŸ¬
[ ] ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì²˜ë¦¬
[ ] ì˜ˆì•½ ì‹œê°„ì´ ê³¼ê±°ì¸ ê²½ìš° ì—ëŸ¬


================================================================================
10. ë³´ì•ˆ ë° ì—ëŸ¬ ì²˜ë¦¬
================================================================================

10.1 ë³´ì•ˆ
--------
âœ… JWT í† í° ê²€ì¦ (ëª¨ë“  API)
âœ… ì‚¬ìš©ìë³„ ë°ì´í„° ê²©ë¦¬ (user_id í•„í„°)
âœ… ì „í™”ë²ˆí˜¸ í˜•ì‹ ê²€ì¦
âœ… SQL Injection ë°©ì§€ (Parameterized Query)
âœ… Rate Limiting (ì¶”í›„ ì¶”ê°€)

10.2 ì—ëŸ¬ ì²˜ë¦¬
------------
í´ë¼ì´ì–¸íŠ¸:
```typescript
try {
  const response = await fetch('/api/messages/send', {...});
  if (!response.ok) {
    const error = await response.json();
    throw new Error(error.error);
  }
  const data = await response.json();
  // ì„±ê³µ ì²˜ë¦¬
} catch (err) {
  const errorMessage = err instanceof Error ? err.message : "ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";
  alert(errorMessage);
}
```

ì„œë²„:
- 200: ì„±ê³µ
- 400: ì˜ëª»ëœ ìš”ì²­
- 401: ì¸ì¦ ì‹¤íŒ¨
- 403: ê¶Œí•œ ì—†ìŒ
- 500: ì„œë²„ ì˜¤ë¥˜


================================================================================
11. ì¹˜í™˜ë¬¸êµ¬ í˜•ì‹ í†µì¼ ë°©ì•ˆ â­ ì‹ ê·œ ì¶”ê°€
================================================================================

11.1 í˜„ì¬ ìƒí™©
-------------
ì˜ˆì•½ ì‹œìŠ¤í…œ (reservations):
- í˜•ì‹: {{ë³€ìˆ˜ëª…}}
- ì˜ˆì‹œ: {{ê³ ê°ëª…}}, {{ê³µê°„ëª…}}, {{ì˜ˆì•½ë‚ ì§œ}}
- íŒŒì„œ: src/utils/messageTemplateParser.ts

messages/send API:
- í˜•ì‹: #[ë³€ìˆ˜ëª…]
- ì˜ˆì‹œ: #[ì´ë¦„], #[ë‚ ì§œ], #[ì‹œê°„]
- íŒŒì„œ: /api/messages/send/route.ts (139-147ì¤„)

ë¬¸ì œì :
- ë‘ ì‹œìŠ¤í…œì—ì„œ ë‹¤ë¥¸ í˜•ì‹ ì‚¬ìš©
- messageTemplateParser.ts ì¬ì‚¬ìš© ë¶ˆê°€
- ì‚¬ìš©ì í˜¼ë€ ê°€ëŠ¥ì„±


11.2 í•´ê²° ë°©ì•ˆ
-------------

ë°©ì•ˆ A: #[ë³€ìˆ˜ëª…] í˜•ì‹ìœ¼ë¡œ í†µì¼ (ì¶”ì²œ)
------------------------------------
ì¥ì :
- messages APIì™€ ì¼ê´€ì„±
- ê¸°ì¡´ API ì½”ë“œ ìœ ì§€

ë‹¨ì :
- reservations ì‹œìŠ¤í…œ ìˆ˜ì • í•„ìš”
- messageTemplateParser.ts ìˆ˜ì • í•„ìš”

êµ¬í˜„:
1. messageTemplateParser.ts ìˆ˜ì •
   - {{ë³€ìˆ˜ëª…}} â†’ #[ë³€ìˆ˜ëª…] ë³€ê²½
   - ì •ê·œì‹: /\{\{[^}]+\}\}/g â†’ /#\[[^\]]+\]/g

2. ê¸°ì¡´ í…œí”Œë¦¿ ë§ˆì´ê·¸ë ˆì´ì…˜
   - DBì—ì„œ ëª¨ë“  í…œí”Œë¦¿ ì¡°íšŒ
   - {{}} â†’ #[] ì¼ê´„ ë³€í™˜
   - UPDATE message_templates SET content = ...

3. UI ì•ˆë‚´ ë¬¸êµ¬ ì—…ë°ì´íŠ¸


ë°©ì•ˆ B: {{ë³€ìˆ˜ëª…}} í˜•ì‹ìœ¼ë¡œ í†µì¼
--------------------------------
ì¥ì :
- messageTemplateParser.ts ê·¸ëŒ€ë¡œ ì‚¬ìš©
- reservations ì‹œìŠ¤í…œ ìˆ˜ì • ë¶ˆí•„ìš”

ë‹¨ì :
- messages API ìˆ˜ì • í•„ìš”
- ì´ë¯¸ ìƒì„±ëœ í…ŒìŠ¤íŠ¸ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜

êµ¬í˜„:
1. /api/messages/send/route.ts ìˆ˜ì •
   - #[ë³€ìˆ˜ëª…] â†’ {{ë³€ìˆ˜ëª…}} ë³€í™˜ ë¡œì§ ì¶”ê°€
   - ë˜ëŠ” messageTemplateParser.ts ì§ì ‘ ì‚¬ìš©

2. í”„ë¡ íŠ¸ì—”ë“œ ì•ˆë‚´ ë¬¸êµ¬ ë³€ê²½
   - SmsMessageContent.tsx placeholder ìˆ˜ì •


ë°©ì•ˆ C: ë‘ í˜•ì‹ ëª¨ë‘ ì§€ì› (í˜¸í™˜ì„±)
---------------------------------
ì¥ì :
- ê¸°ì¡´ ì‹œìŠ¤í…œ ë³€ê²½ ë¶ˆí•„ìš”
- ì‚¬ìš©ì ì„ íƒ ê°€ëŠ¥

ë‹¨ì :
- ë³µì¡ë„ ì¦ê°€
- í˜¼ë€ ê°€ëŠ¥ì„±

êµ¬í˜„:
1. ë²”ìš© íŒŒì„œ í•¨ìˆ˜ ìƒì„±
```typescript
export function replaceVariables(
  template: string,
  variables: Record<string, string>,
  format: '{{}}' | '#[]' = '{{}}'
): string {
  let result = template;

  Object.entries(variables).forEach(([key, value]) => {
    if (format === '{{}}') {
      const pattern = new RegExp(`\\{\\{${key}\\}\\}`, 'g');
      result = result.replace(pattern, value);
    } else {
      const pattern = new RegExp(`#\\[${key}\\]`, 'g');
      result = result.replace(pattern, value);
    }
  });

  return result;
}
```

2. ìë™ ê°ì§€ ë¡œì§
```typescript
function detectVariableFormat(template: string): '{{}}' | '#[]' {
  if (template.includes('{{')) return '{{}}';
  if (template.includes('#[')) return '#[]';
  return '{{}}'; // ê¸°ë³¸ê°’
}
```


11.3 ê¶Œì¥ ì‚¬í•­
-------------
â­ ë°©ì•ˆ A (#{ë³€ìˆ˜ëª…} í†µì¼) ì¶”ì²œ

ì´ìœ :
1. messages íƒ­ì´ ì‹ ê·œ ê¸°ëŠ¥ì´ë¯€ë¡œ í†µì¼ëœ í˜•ì‹ ì ìš© ìš©ì´
2. ì˜ˆì•½ ì‹œìŠ¤í…œê³¼ ë…ë¦½ì ìœ¼ë¡œ ê°œë°œ ê°€ëŠ¥
3. í–¥í›„ í™•ì¥ì„± (ì¹´ì¹´ì˜¤í†¡, RCSë„ ê°™ì€ í˜•ì‹ ì‚¬ìš©)

êµ¬í˜„ ìˆœì„œ:
1. messageTemplateParser.ts ë³µì‚¬ â†’ messageVariableParser.ts ìƒì„±
2. ì •ê·œì‹ ë³€ê²½ ({{}} â†’ #[])
3. messages/send APIì— ì ìš©
4. UI placeholder ì—…ë°ì´íŠ¸
5. ì¶”í›„ reservationsë„ ë§ˆì´ê·¸ë ˆì´ì…˜ ê²€í† 


================================================================================
12. ì—‘ì…€ ì—…ë¡œë“œ êµ¬í˜„ ê°€ì´ë“œ â­ ì‹ ê·œ ì¶”ê°€
================================================================================

12.1 ì—‘ì…€ íŒŒì¼ êµ¬ì¡°
-----------------
ì˜ˆìƒ ì»¬ëŸ¼:
- A: ì´ë¦„ (name)
- B: ì „í™”ë²ˆí˜¸ (phone_number)
- C: ë³€ìˆ˜1 (ì˜ˆ: íšŒì‚¬ëª…)
- D: ë³€ìˆ˜2 (ì˜ˆ: ì§ê¸‰)
- E: ...

ìƒ˜í”Œ:
| ì´ë¦„   | ì „í™”ë²ˆí˜¸      | íšŒì‚¬ëª…  | ì§ê¸‰   |
|--------|---------------|---------|--------|
| í™ê¸¸ë™ | 01012345678   | ABC     | ë¶€ì¥   |
| ê¹€ì² ìˆ˜ | 01087654321   | XYZ     | ê³¼ì¥   |


12.2 API êµ¬í˜„
------------
íŒŒì¼: src/app/api/contacts/import/excel/route.ts

```typescript
import { NextRequest, NextResponse } from "next/server";
import * as XLSX from "xlsx";

export async function POST(request: NextRequest) {
  try {
    // JWT ì¸ì¦
    const authHeader = request.headers.get("authorization");
    if (!authHeader || !authHeader.startsWith("Bearer ")) {
      return NextResponse.json(
        { error: "ì¸ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤" },
        { status: 401 }
      );
    }

    const token = authHeader.substring(7);
    const userId = getUserIdFromToken(token);

    if (!userId) {
      return NextResponse.json(
        { error: "ìœ íš¨í•˜ì§€ ì•Šì€ í† í°ì…ë‹ˆë‹¤" },
        { status: 401 }
      );
    }

    // íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
    const formData = await request.formData();
    const file = formData.get("file") as File;

    if (!file) {
      return NextResponse.json(
        { error: "íŒŒì¼ì´ í•„ìš”í•©ë‹ˆë‹¤" },
        { status: 400 }
      );
    }

    // ì—‘ì…€ íŒŒì‹±
    const arrayBuffer = await file.arrayBuffer();
    const buffer = Buffer.from(arrayBuffer);
    const workbook = XLSX.read(buffer, { type: "buffer" });

    // ì²« ë²ˆì§¸ ì‹œíŠ¸ ì½ê¸°
    const sheetName = workbook.SheetNames[0];
    const sheet = workbook.Sheets[sheetName];

    // JSON ë³€í™˜
    const data = XLSX.utils.sheet_to_json<any>(sheet);

    // ì—°ë½ì²˜ ë³€í™˜
    const contacts = data
      .map((row, index) => {
        // ì „í™”ë²ˆí˜¸ ì¶”ì¶œ (ë‹¤ì–‘í•œ ì»¬ëŸ¼ëª… ì§€ì›)
        const phoneNumber =
          row['ì „í™”ë²ˆí˜¸'] ||
          row['í•¸ë“œí°'] ||
          row['íœ´ëŒ€í°'] ||
          row['ì „í™”'] ||
          row['phone'] ||
          row['tel'];

        if (!phoneNumber) {
          console.warn(`Row ${index + 1}: ì „í™”ë²ˆí˜¸ ì—†ìŒ`);
          return null;
        }

        // ì „í™”ë²ˆí˜¸ ì •ë¦¬ (í•˜ì´í”ˆ ì œê±°)
        const cleanPhone = String(phoneNumber).replace(/[^0-9]/g, '');

        // ìœ íš¨ì„± ê²€ì¦
        if (!/^01[0-9]{8,9}$/.test(cleanPhone)) {
          console.warn(`Row ${index + 1}: ì˜¬ë°”ë¥´ì§€ ì•Šì€ ì „í™”ë²ˆí˜¸ ${phoneNumber}`);
          return null;
        }

        // ì´ë¦„ ì¶”ì¶œ
        const name = row['ì´ë¦„'] || row['ì„±ëª…'] || row['name'] || '';

        // ì¹˜í™˜ ë³€ìˆ˜ ì¶”ì¶œ (ì´ë¦„, ì „í™”ë²ˆí˜¸ ì œì™¸í•œ ëª¨ë“  ì»¬ëŸ¼)
        const variables: Record<string, string> = {};
        Object.entries(row).forEach(([key, value]) => {
          if (
            !['ì´ë¦„', 'ì„±ëª…', 'name', 'ì „í™”ë²ˆí˜¸', 'í•¸ë“œí°', 'íœ´ëŒ€í°', 'ì „í™”', 'phone', 'tel'].includes(key) &&
            value !== null &&
            value !== undefined
          ) {
            variables[key] = String(value);
          }
        });

        return {
          phone_number: cleanPhone,
          name: name,
          variables: variables
        };
      })
      .filter(contact => contact !== null);

    // ì¤‘ë³µ ì œê±° (ì „í™”ë²ˆí˜¸ ê¸°ì¤€)
    const uniqueContacts = Array.from(
      new Map(contacts.map(c => [c.phone_number, c])).values()
    );

    return NextResponse.json({
      success: true,
      count: uniqueContacts.length,
      contacts: uniqueContacts
    });

  } catch (error) {
    console.error("ì—‘ì…€ ì—…ë¡œë“œ ì˜¤ë¥˜:", error);
    return NextResponse.json(
      { error: "ì—‘ì…€ íŒŒì¼ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤" },
      { status: 500 }
    );
  }
}

function getUserIdFromToken(token: string): number | null {
  try {
    const payload = JSON.parse(
      Buffer.from(token.split(".")[1], "base64").toString()
    );
    return payload.userId || null;
  } catch {
    return null;
  }
}
```


12.3 í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„
------------------
íŒŒì¼: MessageSendTab.tsx

```typescript
const handleExcelUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {
  const file = event.target.files?.[0];
  if (!file) return;

  // íŒŒì¼ í˜•ì‹ í™•ì¸
  if (!file.name.endsWith('.xlsx') && !file.name.endsWith('.xls')) {
    alert('ì—‘ì…€ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤ (.xlsx, .xls)');
    return;
  }

  setIsLoading(true);
  setError(null);

  try {
    const token = localStorage.getItem("access_token");
    if (!token) {
      throw new Error("ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤");
    }

    const formData = new FormData();
    formData.append('file', file);

    const response = await fetch('/api/contacts/import/excel', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${token}`
      },
      body: formData
    });

    const data = await response.json();

    if (!response.ok) {
      throw new Error(data.error || 'ì—‘ì…€ ì—…ë¡œë“œì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤');
    }

    // ê¸°ì¡´ ìˆ˜ì‹ ì ëª©ë¡ì— ì¶”ê°€
    setRecipients([...recipients, ...data.contacts]);
    alert(`${data.count}ê°œì˜ ì—°ë½ì²˜ë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤.`);

    // íŒŒì¼ input ì´ˆê¸°í™”
    event.target.value = '';

  } catch (err) {
    const errorMessage = err instanceof Error ? err.message : "ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜";
    setError(errorMessage);
    alert(`ì—…ë¡œë“œ ì‹¤íŒ¨: ${errorMessage}`);
  } finally {
    setIsLoading(false);
  }
};
```

JSX ì¶”ê°€ (ê¸°ì¡´ inputì— onChangeë§Œ ì—°ê²°):
```typescript
<input
  type="file"
  accept=".xlsx,.xls"
  onChange={handleExcelUpload}
  style={{ display: 'none' }}
  id="excel-upload"
/>
<label htmlFor="excel-upload">
  <button type="button">ì—‘ì…€ ì—…ë¡œë“œ</button>
</label>
```


12.4 ì—‘ì…€ ìƒ˜í”Œ ìƒì„±
-----------------
ì‚¬ìš©ìì—ê²Œ ì œê³µí•  ìƒ˜í”Œ íŒŒì¼:

```typescript
// ìƒ˜í”Œ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜
const downloadSampleExcel = () => {
  const sampleData = [
    { ì´ë¦„: 'í™ê¸¸ë™', ì „í™”ë²ˆí˜¸: '01012345678', íšŒì‚¬ëª…: 'ABC', ì§ê¸‰: 'ë¶€ì¥' },
    { ì´ë¦„: 'ê¹€ì² ìˆ˜', ì „í™”ë²ˆí˜¸: '01087654321', íšŒì‚¬ëª…: 'XYZ', ì§ê¸‰: 'ê³¼ì¥' },
  ];

  const worksheet = XLSX.utils.json_to_sheet(sampleData);
  const workbook = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(workbook, worksheet, "ì—°ë½ì²˜");

  XLSX.writeFile(workbook, "ì—°ë½ì²˜_ìƒ˜í”Œ.xlsx");
};
```


12.5 ì£¼ì˜ì‚¬í•­
------------
1. íŒŒì¼ í¬ê¸° ì œí•œ (ì˜ˆ: 5MB)
2. í–‰ ê°œìˆ˜ ì œí•œ (ì˜ˆ: 1000ê°œ)
3. ì—ëŸ¬ ë¡œê¹… (íŒŒì‹± ì‹¤íŒ¨í•œ í–‰ ê¸°ë¡)
4. ì§„í–‰ ìƒíƒœ í‘œì‹œ (ëŒ€ìš©ëŸ‰ íŒŒì¼)
5. ì¤‘ë³µ ì „í™”ë²ˆí˜¸ ì²˜ë¦¬


================================================================================
13. ìµœì¢… í™•ì¸ ì‚¬í•­
================================================================================

êµ¬í˜„ ì‹œì‘ ì „ ì²´í¬:
------------------
[âœ…] ì´ ê³„íšì„œë¥¼ ì²˜ìŒë¶€í„° ëê¹Œì§€ ì½ì—ˆëŠ”ê°€?
[âœ…] UI ìˆ˜ì • ê¸ˆì§€ ì›ì¹™ì„ ì´í•´í–ˆëŠ”ê°€?
[âœ…] ê¸°ì¡´ ë¦¬ì†ŒìŠ¤ (API, ë¼ì´ë¸ŒëŸ¬ë¦¬)ë¥¼ íŒŒì•…í–ˆëŠ”ê°€?
[âœ…] ê³µí†µ ë¡œì§ ì¶”ì¶œ ì „ëµì„ ì´í•´í–ˆëŠ”ê°€?
[âœ…] 7ì¼ êµ¬í˜„ ì¼ì •ì„ í™•ì¸í–ˆëŠ”ê°€?

êµ¬í˜„ ì¤‘ ì²´í¬:
------------
[âœ…] ğŸš« UI íŒŒì¼(JSX)ì„ ìˆ˜ì •í•˜ê³  ìˆì§€ ì•Šì€ê°€?
[âœ…] âœ… API ì—”ë“œí¬ì¸íŠ¸ë§Œ ìƒì„±í•˜ê³  ìˆëŠ”ê°€?
[âœ…] âœ… ê¸°ì¡´ ìœ í‹¸ë¦¬í‹°ë¥¼ ì¬ì‚¬ìš©í•˜ê³  ìˆëŠ”ê°€?
[âœ…] âœ… í…ŒìŠ¤íŠ¸ë¥¼ ë³‘í–‰í•˜ê³  ìˆëŠ”ê°€?

êµ¬í˜„ ì™„ë£Œ í›„ ì²´í¬:
----------------
[âœ…] ì¦‰ì‹œ ë°œì†¡ APIê°€ ì •ìƒ ë™ì‘í•˜ëŠ”ê°€?
[âœ…] í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë°œì†¡ì´ ê°€ëŠ¥í•œê°€?
[âœ…] ì”ì•¡ ì°¨ê°ì´ ì •ìƒ ë™ì‘í•˜ëŠ”ê°€?
[ ] ì˜ˆì•½ ë°œì†¡ì´ ì •ìƒ ë™ì‘í•˜ëŠ”ê°€?
[âœ…] ì—ëŸ¬ ì¼€ì´ìŠ¤ê°€ ì ì ˆíˆ ì²˜ë¦¬ë˜ëŠ”ê°€?
[âœ…] ğŸš« UIê°€ ë³€ê²½ë˜ì§€ ì•Šì•˜ëŠ”ê°€?
[âœ…] ESLint ì—ëŸ¬ê°€ ì—†ëŠ”ê°€?


================================================================================
14. ì°¸ê³  ì‚¬í•­
================================================================================

14.1 ë©”ì‹œì§€ íƒ€ì…ë³„ ë‹¨ê°€
---------------------
- SMS (90ë°”ì´íŠ¸ ì´í•˜): 20ì›
- LMS (91ë°”ì´íŠ¸ ì´ìƒ): 50ì›
- MMS (ì´ë¯¸ì§€ í¬í•¨): 200ì› (ì¶”í›„ êµ¬í˜„)

14.2 ì¹˜í™˜ë¬¸êµ¬ í˜•ì‹
----------------
- ì˜ˆì•½ ì‹œìŠ¤í…œ: {{ë³€ìˆ˜ëª…}} í˜•ì‹
- messages API: #[ë³€ìˆ˜ëª…] í˜•ì‹
- ì˜ˆì‹œ: "ì•ˆë…•í•˜ì„¸ìš” #[ì´ë¦„]ë‹˜, #[ì‹œê°„]ì— ë°©ë¬¸ ì˜ˆì•½ë˜ì—ˆìŠµë‹ˆë‹¤."

14.3 ì „í™”ë²ˆí˜¸ í˜•ì‹
----------------
- í˜•ì‹: 01012345678 (í•˜ì´í”ˆ ì œê±°)
- ì •ê·œì‹: /^01[0-9]{8,9}$/

14.4 ê°œë°œ í™˜ê²½
-------------
- Node.js: v18+
- Next.js: 15.3.2
- TypeScript: 5+
- Supabase: PostgreSQL


================================================================================
15. ë³€ê²½ ì´ë ¥
================================================================================

2025-10-13:
-----------
[ì¶”ê°€] ì„¹ì…˜ 11: ì¹˜í™˜ë¬¸êµ¬ í˜•ì‹ í†µì¼ ë°©ì•ˆ
[ì¶”ê°€] ì„¹ì…˜ 12: ì—‘ì…€ ì—…ë¡œë“œ êµ¬í˜„ ê°€ì´ë“œ
[ì—…ë°ì´íŠ¸] ì„¹ì…˜ 2.3: ê¸°ì¡´ ë¼ì´ë¸ŒëŸ¬ë¦¬ ìƒì„¸ ì„¤ëª…
[ì—…ë°ì´íŠ¸] ì„¹ì…˜ 6: ESLint ì—ëŸ¬ ìˆ˜ì • ì™„ë£Œ
[ì—…ë°ì´íŠ¸] ì„¹ì…˜ 7: Day 1-2 ì™„ë£Œ í‘œì‹œ
[ì—…ë°ì´íŠ¸] ì„¹ì…˜ 8: í”„ë¡ íŠ¸ì—”ë“œ ì—°ë™ í˜„í™©
[í™•ì¸] xlsx ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ í™•ì¸
[í™•ì¸] messageTemplateParser.ts ëª¨ë“  í•¨ìˆ˜ í™•ì¸


================================================================================
ë¬¸ì„œ ë
================================================================================

ğŸ“Œ ë§ˆì§€ë§‰ ì²´í¬:
[âœ…] UI ìˆ˜ì • ê¸ˆì§€ ì›ì¹™ì„ ìˆ™ì§€í–ˆìŠµë‹ˆê¹Œ? â†’ YES
[âœ…] êµ¬í˜„ ê³„íšì„ ì´í•´í–ˆìŠµë‹ˆê¹Œ? â†’ YES
[âœ…] ê¸°ì¡´ ë¦¬ì†ŒìŠ¤ë¥¼ íŒŒì•…í–ˆìŠµë‹ˆê¹Œ? â†’ YES
[âœ…] ì¹˜í™˜ë¬¸êµ¬ í˜•ì‹ í†µì¼ ë°©ì•ˆì„ ê²€í† í–ˆìŠµë‹ˆê¹Œ? â†’ YES
[âœ…] ì—‘ì…€ ì—…ë¡œë“œ êµ¬í˜„ ë°©ë²•ì„ ì´í•´í–ˆìŠµë‹ˆê¹Œ? â†’ YES

âœ… ëª¨ë‘ YESë¼ë©´ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰í•˜ì„¸ìš”!
ğŸš« UIëŠ” ì ˆëŒ€ ê±´ë“œë¦¬ì§€ ë§ê³  APIë§Œ êµ¬í˜„í•˜ì„¸ìš”!

â­ ë‹¤ìŒ ìš°ì„ ìˆœìœ„:
1. ë©”ì‹œì§€ í…œí”Œë¦¿ API êµ¬í˜„ ë° ì—°ë™ (2ì‹œê°„)
2. ì—‘ì…€ ì—…ë¡œë“œ ê¸°ëŠ¥ êµ¬í˜„ (4ì‹œê°„)
3. ì˜ˆì•½ ë°œì†¡ UI ì¶”ê°€ (6ì‹œê°„)

================================================================================
