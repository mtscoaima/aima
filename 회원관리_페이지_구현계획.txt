===================================================================
                     회원관리 페이지 구현 계획서
===================================================================

■ 프로젝트 개요
  - 프로젝트명: MTS 메시징 플랫폼 회원관리 시스템
  - 목적: 관리자용 종합 회원관리 시스템 구축
  - 작성일: 2025년 1월
  - 최종 수정일: 2025년 1월 (구현 상황 반영)
  - 대상 사용자: 시스템 관리자, 운영진

■ 구현 진행 상황
  ✅ 완료: 회원 정보 관리 (100%)
  🔄 진행중: 회원 등급 관리 (UI 완료, 기능 구현 필요)
  🔄 진행중: 로그인/접속 관리 (UI 완료, 기능 구현 필요)

===================================================================
1. 회원 정보 관리 ✅ 완료
===================================================================

■ 1-1. 화면 목적 ✅
  - 전체 회원 목록 조회 및 검색 ✅
  - 회원 정보 상세 보기 및 수정 ✅
  - 회원 상태(정상, 정지, 탈퇴 등) 변경 ✅
  - 회원 등록 및 권한 관리 ✅
  - 일괄 처리 기능 (승인, 거부, 정지, 삭제) ✅
  - Excel 데이터 내보내기 ✅

■ 1-2. 화면 구성요소 ✅

  가. 상단 통계 영역 ✅
    - 전체 회원 수: 동적 카운트 (실시간 업데이트)
    - 회원 유형별 현황: 개인/기업 회원 통계
    - 상태별 현황: 정상/정지/탈퇴/대기/거부 회원 수

  나. 검색 필터 영역 ✅
    ┌─────────────────────────────────────────────────┐
    │ [회원유형 ▼] [기업명 ▼] [검색조건 ▼] [검색어 입력] [검색] │
    │ - 회원유형: 전체/개인/기업 ✅                     │
    │ - 기업명: 실제 DB에서 로드된 기업 목록 ✅          │
    │ - 검색조건: 사용자ID/사용자이름/가입일 ✅          │
    │ - 검색어: 조건에 따른 입력 필드 ✅                │
    └─────────────────────────────────────────────────┘

  다. 회원 목록 테이블 ✅
    ┌──────────────────────────────────────────────────────────────┐
    │ [☐ 전체선택] [선택 항목 일괄처리 ▼] [회원 등록] [Excel 다운로드] │
    ├──────────────────────────────────────────────────────────────┤
    │ ☐│사용자ID │사용자명│기업명 │회원유형│이메일    │연락처     │상태│
    │ ☐│sales4  │홍길동 │-     │개인   │tesung@..│010123..  │정상│
    │ ☐│hspark  │박희수 │테스트회사│기업   │hspark@..│010-9255..│정상│
    ├──────────────────────────────────────────────────────────────┤
    │ 등급│가입일    │수정일      │최종로그인    │관리            │
    │ 일반│2025-07-22│2025-08-07 │2025.8.4.오후1:43│[상세][수정][삭제]│
    │ 일반│2025-07-17│2025-08-06 │2025.7.28.오후1:34│[상세][수정][삭제]│
    └──────────────────────────────────────────────────────────────┘
    
    🔧 구현된 기능:
    - 체크박스 전체선택/개별선택 ✅
    - 일괄처리 (활성화, 정지, 승인, 거부, 삭제) ✅
    - 페이지네이션 (50개씩) ✅
    - 실시간 데이터 로딩 ✅
    - 로딩 스피너 최적화 ✅

  라. 회원 등록 모달 ✅
    - 기본 정보: 사용자ID, 사용자명, 기업명, 회원유형 ✅
    - 연락처 정보: 이메일, 연락처 ✅
    - 권한 설정: 사용자/영업자/관리자/운영자 ✅
    - 초기 상태: 정상 (관리자 생성 시 자동 승인) ✅
    - 비밀번호: 기본값 "temp123!" 설정 ✅

  마. 회원 상세정보 모달 ✅
    - 회원 상세보기: 모든 정보 조회 가능 ✅
    - 회원 정보 수정: 기본 정보 수정 ✅
    - 상태 변경: 정상/정지/탈퇴/대기/거부 ✅
    - 회원 삭제: 확인 후 삭제 처리 ✅
    - 반응형 모달 UI ✅

■ 1-3. 상태 코드 정의 ✅
  - 정상: 활성 회원 (서비스 이용 가능) ✅
  - 정지: 계정 정지 (로그인 불가) ✅
  - 탈퇴: 탈퇴 처리된 회원 ✅
  - 대기: 승인 대기 중 (제한적 이용) ✅
  - 거부: 승인 거부된 회원 ✅

■ 1-4. 보안 정책 🔄
  - 개인정보 마스킹: 미구현 ❌
  - 수정 기록 로그화: 부분 구현 (approval_log) 🔄
  - 권한별 접근 제어: JWT + 관리자 권한 체크 ✅
  - 비밀번호 해싱: bcryptjs 사용 ✅

===================================================================
2. 회원 등급 관리 🔄 UI 완료, 기능 구현 필요
===================================================================

■ 2-1. 화면 목적 🔄
  - 등급별 조건 정의 및 관리 ❌
  - 등급별 혜택 내용 설정 ❌
  - 등급 변경 이력 조회 ❌
  - 수동 등급 조정 기능 ❌
  - 등급 통계 표시 ✅ (정적 데이터)

■ 2-2. 회원 등급 기준 (최근 3개월 서비스 이용금액)
  ┌─────────────────────────────────────────────────┐
  │ 등급   │ 조건                │ 혜택              │
  ├─────────────────────────────────────────────────┤
  │ 일반   │ 전월 사용금액 3만원 이하  │ 기본 서비스 이용    │
  │ 실버   │ 전월 사용금액 3~5만원    │ 생일쿠폰 제공      │
  │ 골드   │ 전월 사용금액 5~10만원   │ 포인트 적립 혜택    │
  │ VIP    │ 전월 사용금액 10만원 이상 │ 전용쿠폰, 우선지원  │
  └─────────────────────────────────────────────────┘

■ 2-3. 화면 구성요소 🔄

  가. 등급 기준 설정 ❌
    - 등급별 금액 조건 입력 (미구현)
    - 기준 기간 설정 (월/분기/년) (미구현)
    - 승급/강등 조건 설정 (미구현)

  나. 혜택 관리 ❌
    - 등급별 혜택 내용 입력 (미구현)
    - 쿠폰/포인트 적립률 설정 (미구현)
    - 서비스 이용 혜택 정의 (미구현)

  다. 등급 이력 조회 ❌
    - 필터: 등급 변경일, 변경 사유, 회원 등급 (미구현)
    - 자동 승급/강등 이력 (미구현)
    - 수동 조정 이력 (미구현)

  라. 등급 현황 테이블 ✅ (정적 UI)
    - 일반, 실버, 골드, VIP 등급 표시 ✅
    - 각 등급별 회원 수 카운트 ✅
    - 수정 버튼 (console.log만 동작) 🔄

===================================================================
3. 로그인/접속 관리 🔄 UI 완료, 기능 구현 필요
===================================================================

■ 3-1. 화면 목적 🔄
  - 로그인 이력 실시간 모니터링 ❌
  - 접속 IP, 시간, 디바이스 정보 확인 ❌
  - 이상 로그인 탐지 및 대응 ❌
  - 세션 관리 및 강제 종료 ❌
  - 접속 현황 UI 표시 ✅ (정적 데이터)

■ 3-2. 화면 구성요소 🔄

  가. 실시간 접속 현황 ✅ (정적 UI)
    ┌─────────────────────────────────────────────────┐
    │ 현재 접속자: 0명    │ 오늘 신규 로그인: 0명       │
    │ 이상 로그인: 0건    │ 차단된 IP: 0개             │
    └─────────────────────────────────────────────────┘

  나. 검색 필터 영역 ✅ (정적 UI)
    - 회원유형: 개인/기업 ✅
    - 기업명: 기업 목록 선택 ✅
    - 검색조건: 사용자ID/사용자이름/가입일 ✅
    - 기간 설정: 시작일 ~ 종료일 ✅
    - 상태 필터: 로그인 성공/실패, 세션 활성/비활성 ✅

  다. 접속 이력 테이블 ✅ (정적 UI)
    ┌──────────────────────────────────────────────────────────────┐
    │사용자ID│사용자명│기업명 │접속 IP    │접속일시      │성공여부│세션상태│
    │ (샘플 데이터 표시 중 - 실제 로그인 데이터 연동 필요)           │
    └──────────────────────────────────────────────────────────────┘

  라. 세션 관리 ❌
    - 활성 세션 목록 (미구현)
    - 세션 강제 종료 기능 (미구현)
    - 세션 타임아웃 설정 (미구현)

■ 3-3. 보안 정책

  가. 이상 로그인 탐지
    - 동일 사용자 다중 접속 감지 (3개 이상 세션)
    - 반복 로그인 실패 감지 (5회 이상 실패)
    - 비정상적인 접속 패턴 감지

  나. 자동 보안 조치
    - 일정시간 비활성 세션 강제 종료 (30분)
    - 의심스러운 IP 자동 차단
    - 계정 임시 잠금 (반복 실패 시)

  다. 알림 시스템
    - 이상 로그인 실시간 알림
    - 관리자 대시보드 경고 표시
    - 이메일/SMS 긴급 알림

===================================================================
4. 기술 구현 사항
===================================================================

■ 4-1. 데이터베이스 설계
  - users 테이블: 회원 기본 정보
  - user_grades 테이블: 회원 등급 정보
  - user_grade_history 테이블: 등급 변경 이력
  - login_logs 테이블: 로그인 이력
  - user_sessions 테이블: 세션 관리
  - admin_logs 테이블: 관리자 작업 이력

■ 4-2. API 엔드포인트 🔄
  ✅ 구현 완료:
  - GET /api/admin/users - 회원 목록 조회 (필터링, 페이징, 통계 포함) ✅
  - PUT /api/admin/users - 회원 정보 수정 ✅
  - POST /api/admin/users - 회원 등록 ✅
  - DELETE /api/admin/users - 회원 삭제 ✅
  - POST /api/admin/users/bulk - 일괄 처리 ✅
  - GET /api/admin/users/export - Excel 내보내기 ✅
  - GET /api/admin/companies - 기업 목록 조회 ✅
  
  ❌ 미구현:
  - GET /api/admin/users/:id - 개별 회원 상세 조회 (모달에서 처리)
  - GET /api/admin/login-logs - 로그인 이력 조회 ❌
  - POST /api/admin/sessions/:id/terminate - 세션 강제 종료 ❌
  - GET /api/admin/grades - 등급 관리 API ❌

■ 4-3. 보안 고려사항
  - JWT 기반 인증/인가
  - RBAC (Role-Based Access Control) 구현
  - 개인정보 암호화 저장
  - 마스킹 처리 로직
  - XSS, CSRF 방어
  - Rate Limiting 적용

■ 4-4. 성능 최적화
  - 페이징 처리 (기본 50개씩)
  - 인덱스 최적화
  - 캐싱 전략 (Redis)
  - 비동기 처리 (대용량 데이터)

===================================================================
5. 개발 진행 상황 (2025년 1월 기준)
===================================================================

■ ✅ 완료된 작업:
  - 데이터베이스 연동 및 기본 API 개발 ✅
  - 회원 정보 관리 화면 완전 구현 ✅
  - 회원 등급 관리 UI 구현 ✅
  - 로그인/접속 관리 UI 구현 ✅
  - JWT 인증 및 권한 관리 ✅
  - Excel 내보내기 기능 ✅

■ 🔄 진행 중인 작업:
  - 개인정보 마스킹 처리
  - 수정 이력 로그 시스템 고도화

■ ❌ 향후 구현 필요:
  - 회원 등급 관리 실제 기능 (API 연동)
  - 로그인 이력 추적 시스템
  - 세션 관리 및 실시간 모니터링
  - 이상 로그인 탐지 시스템

===================================================================
6. 다음 개발 우선순위
===================================================================

■ 6-1. 단기 목표 (1-2주)
  - 🔥 회원 등급 관리 기능 API 개발 및 연동
  - 🔥 로그인 이력 추적 시스템 구현
  - 개인정보 마스킹 처리 (이름, 연락처, 이메일)
  - 수정 이력 상세 로그 시스템

■ 6-2. 중기 목표 (1개월)
  - 세션 관리 및 실시간 모니터링
  - 이상 로그인 탐지 시스템
  - 통계 대시보드 확장
  - 성능 최적화 (인덱싱, 캐싱)

■ 6-3. 장기 목표 (3개월)
  - 회원 행동 패턴 분석
  - 자동 등급 조정 알고리즘
  - 머신러닝 기반 이상 탐지
  - 종합 보안 모니터링 시스템

■ 6-4. 운영 계획
  - 정기 백업 및 복구 테스트
  - 보안 이벤트 추적 및 알림
  - 사용자 활동 분석 리포트
  - 시스템 성능 모니터링

===================================================================
                        구현 현황 요약
===================================================================

🎯 전체 진행률: 약 70% 완료

📊 모듈별 완성도:
  ✅ 회원 정보 관리: 100% (완전 구현)
  🔄 회원 등급 관리: 30% (UI 완료, API 필요)
  🔄 로그인/접속 관리: 30% (UI 완료, API 필요)

🔧 핵심 구현 완료 기능:
  - 회원 목록 조회/검색/필터링
  - 회원 등록/수정/삭제
  - 상태 관리 (정상/정지/탈퇴/대기/거부)
  - 일괄 처리 (승인/거부/활성화/정지/삭제)
  - Excel 데이터 내보내기
  - 페이지네이션 및 통계
  - JWT 인증 및 관리자 권한 체크

🚀 다음 우선 개발 항목:
  1. 회원 등급 관리 API 개발
  2. 로그인 이력 추적 시스템
  3. 개인정보 마스킹 처리

===================================================================
                           문서 끝
===================================================================
