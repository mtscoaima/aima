# CNSPay_Non-PG_연동가이드_v3.1_20250829

LG CNS
CNSPay Non-PG Module
연동가이드
Ver. 3.1
본 문서와 정보는 LG CNS 재산입니다. 또한, 모든 정보는 LG CNS 소유 정보이며, LG CNS 사전
동의 없이 본 문서의 어떤 정보도 열람, 복사, 유용, 또는 타인과 공유되어서는 안됩니다.
본 문서의 정보는 변경될 수 있으며 변경 시, 본 문서는 수정될 것입니다. 본 문서의 내용에
관한 어떠한 의견이라도 귀하의 프로젝트 또는 사업 담당자에게 전달하여 주십시오.
COPYRIGHT 2025 LG CNS. ALL RIGHTS RESERVED
1 / 31

개 정 이 력
버전 변경일 변경 내용 작성자 승인자
1.0 22.03.21 최초작성 L.W.S Y.S.J
1.1 22.04.01 모바일 앱 관련 내용 등 추가 L.W.S Y.S.J
1.2 22.04.12 현금영수증 관련 내용 추가, 일부 정보 수정 L.W.S Y.S.J
1.3 22.04.14 AES256 암호화 관련 수정, 일부 API 파라미터 변경 L.W.S Y.S.J
1.4 22.04.15 인증 이후 결과 수신 샘플, 신용카드 응답 파라미터 추가 L.W.S Y.S.J
1.5 22.04.19 거래상태조회 기능 고도화 L.W.S Y.S.J
22.06.20 농협카드 명칭 변경
가상계좌 은행 코드 현행화 및 배경 Dim 처리 여부
1.6 22.07.26 J.S.W Y.S.J
파라미터 추가
22.09.14
가상계좌 수취인명 파라미터 설명 추가
1.7 23.02.03 1QPay(외한, 하나)카드코드 통합 S.J.W Y.S.J
23.02.14 신용카드 법인/개인 구분 응답 파라미터 추가
23.02.20 서비스 이용 유의사항 항목 추가
1.8 S.J.W Y.S.J
23.06.30 신한카드 결제창 전면 노출 파라미터 추가
23.07.10 거래초기화값, 인증결과key값 유효시간 내용 추가
거래초기화 요청/응답 파라미터 추가
23.11.27
인증 Page 호출방식 내용수정 및 신용카드 결제수단
23.12.15
1.9 요청 파라미터 추가, 하나1Q페이 명칭변경 S.J.W Y.S.J
23.12.19
신한카드 Android-신규 패키지 추가
24.03.27
Android-패키지, iOS-URL Scheme 현행화 가이드 추가
24.06.04 주문자 정보 관련 요청 파라피터 필수 여부 변경
24.06.18 서버 IP 변경 및 대구은행 사명 변경
2.0 S.J.W Y.S.J
24.09.30 주문자 정보 관련 요청 파라미터 내용 추가
25.03.24 가상계좌 은행코드 수협은행 제거
25.04.17 2차PG 연동 관련 추가
3.0 25.04.30 취소확인 flag 추가 L.W.S J.M.H
25.05.07 취소 DiscountAmt 파라미터 설명 추가
25.05.28 인증창 레이어 팝업 호출 시 사이즈 조절 내용 추가
3.1 S.J.W
25.06.09 현금영수증 파라미터 관련 내용 수정
3.2 25.08.29 구매자정보 파라미터 관련 수정 S.J.W
2 / 31

목 차
1. 서비스 개요 및 특징 ............................................................................................................................................................................................................................................. 5
1.1. 서비스 개요.......................................................................................................................................................................................................................................................... 5
1.2. 제품의 특징.......................................................................................................................................................................................................................................................... 5
2. 환경설정 및 준비하기 .......................................................................................................................................................................................................................................... 6
2.1. 방화벽 및 time-out 설정 ..................................................................................................................................................................................................................... 6
2.2. 보안 취약 프로토콜 허용 중지 및 업그레이드 적용 가이드 .......................................................................................................................... 6
2.3. 가상계좌 입금통보 기능 사용설정 및 가맹점 Source IP 등록 요청 ...................................................................................................... 6
입금통보 기능 사용 설정 및 가맹점정보 등록 안내 ................................................................................................................................................ 7
2.4. 서비스 이용 시 유의사항 ...................................................................................................................................................................................................................... 7
3. 결제 연동 ........................................................................................................................................................................................................................................................................... 8
3.1. 거래초기화............................................................................................................................................................................................................................................................. 9
거래초기화 API URL .................................................................................................................................................................................................................................... 9
Request Header ............................................................................................................................................................................................................................................... 9
Request Body ..................................................................................................................................................................................................................................................... 9
Response ................................................................................................................................................................................................................................................................. 9
3.2. 인증 Page 연동 ........................................................................................................................................................................................................................................... 10
JavaScript Include 설정 : 인증 Page 연동 호출 시 사용 ............................................................................................................................... 10
인증 Page 호출, 결제 요청, 인증 취소 시 호출되는 Function 안내 및 Sample.................................................................. 10
레이어 팝업 호출 시 팝업창 사이즈 조절 ....................................................................................................................................................................... 12
Request : 결제수단 공통 항목 ..................................................................................................................................................................................................... 12
Request : 신용카드 결제수단 추가 항목 ........................................................................................................................................................................... 13
Request : 네이버페이, 카카오페이, 페이코 결제수단 추가 항목 ............................................................................................................. 13
Response ............................................................................................................................................................................................................................................................. 14
3.3. 결제 승인 요청 ............................................................................................................................................................................................................................................. 14
결제 승인 요청 API URL .................................................................................................................................................................................................................... 14
Request Header ........................................................................................................................................................................................................................................... 14
Request Body : 결제수단 공통 항목 ...................................................................................................................................................................................... 14
Request Body : 가상계좌 결제수단 추가 항목 ........................................................................................................................................................... 15
Request Body : 현금영수증 추가 항목 ................................................................................................................................................................................ 16
Response : 결제수단 공통 항목 ................................................................................................................................................................................................. 16
Response : 신용카드 결제수단 추가 항목 ....................................................................................................................................................................... 17
Response : 가상계좌 결제수단 추가 항목 ....................................................................................................................................................................... 17
Response : 네이버페이, 카카오페이, 페이코 결제수단 추가 항목.......................................................................................................... 18
3.4. 결제 취소 요청 ............................................................................................................................................................................................................................................. 18
결제 취소 요청 API URL .................................................................................................................................................................................................................... 18
Request Header ........................................................................................................................................................................................................................................... 19
Request Body : 결제수단 공통 항목 ...................................................................................................................................................................................... 19
Request Body : 가상계좌 결제수단 추가 항목 ........................................................................................................................................................... 19
Reponse : 결제수단 공통 항목 .................................................................................................................................................................................................... 20
Reponse : 네이버페이, 카카오페이, 페이코 추가 항목 ....................................................................................................................................... 20
3.5. 거래상태 조회 요청 ................................................................................................................................................................................................................................. 21
거래상태 조회 요청 API URL ........................................................................................................................................................................................................ 21
Request Header ........................................................................................................................................................................................................................................... 21
Request Body ................................................................................................................................................................................................................................................. 21
Response ............................................................................................................................................................................................................................................................. 21
3 / 31

3.6. 가상계좌 입금통보 .................................................................................................................................................................................................................................... 23
가상계좌 입금통보 Request Header...................................................................................................................................................................................... 23
가상계좌 입금통보 Request Body ............................................................................................................................................................................................ 23
전문 암호화 처리 ........................................................................................................................................................................................................................................ 24
필드 복호화 처리 ........................................................................................................................................................................................................................................ 24
가상계좌 입금통보 Response Body ........................................................................................................................................................................................ 24
응답전문 예시 ................................................................................................................................................................................................................................................. 24
가상계좌 입금 통보 시 결과 코드 ........................................................................................................................................................................................... 25
4. 결제 및 취소 테스트 시 주의사항 ..................................................................................................................................................................................................... 26
4.1 결제 테스트 시 주의사항 ................................................................................................................................................................................................................... 26
1) 일반 가맹점 ........................................................................................................................................................................................................................................ 26
2) 복합과세 가맹점 ............................................................................................................................................................................................................................ 26
4.2 취소 테스트 시 주의사항 ................................................................................................................................................................................................................... 26
5. 참고자료 .......................................................................................................................................................................................................................................................................... 27
5.1. 모바일 앱 연동 관련 안내 ............................................................................................................................................................................................................... 27
안드로이드 .......................................................................................................................................................................................................................................................... 27
iOS .............................................................................................................................................................................................................................................................................. 28
5.2. 신용카드 코드 ................................................................................................................................................................................................................................................ 28
5.3. ISP 거래 카드 세부 발급사 코드 .............................................................................................................................................................................................. 29
5.4. 가상계좌 은행 코드 ................................................................................................................................................................................................................................. 30
5.5. DirectSH 적용 예시 ................................................................................................................................................................................................................................. 30
4 / 31

CNSPay Non-PG Module Manual
1. 서비스 개요 및 특징
1.1. 서비스 개요
본 가이드는 LG CNS가 제공하는 CNSPay 전자결제 서비스의 Non-PG 방식을 연동하고자 하는 가맹점을 위한 기
술 안내서입니다.
CNSPay Non-PG 전자결제 모듈은 신용카드, 가상계좌는 물론, 네이버페이, 카카오페이, 페이코 등 주요 간편결제
수단을 포함한 다양한 결제 방식을 지원합니다.
본 모듈은 PG사의 결제창이나 별도 라이브러리 없이, 가맹점에서 직접 결제 요청 및 응답을 처리할 수 있도록 설
계되어 있습니다.
또한, 변조 방지 기능을 기본 내장하고 있어 별도의 보안 장비 없이도 안전한 인터넷 전자결제 환경을 구현할 수
있도록 지원합니다.
LG CNS는 실시간 응답 처리, 높은 안정성, 신뢰성을 기반으로, 간편하고 효율적인 전자결제 연동 환경을 제공합니
다.
1.2. 제품의 특징
CNSPay Non-PG 서비스는 LG CNS의 전자결제 시스템으로, 별도의 보안 장치 없이도 위·변조 방지를 위한 자체
암호화 기술을 적용하여 안전한 결제 처리를 지원합니다. 또한 PG사의 결제창을 사용하지 않기 때문에, 결제 절차
가 간소화되어 사용자 경험이 개선됩니다.
본 서비스는 가맹점에서 별도의 라이브러리 설치 없이 RESTful API 방식으로 연동할 수 있으며, PC와 모바일 환경
모두에서 결제가 가능합니다.
개발자의 편의성을 고려하여 인터페이스를 단순화하였으며, 최소한의 개발 리소스로도 손쉽게 연동이 가능하도록
구성되어 있습니다.
본 가이드의 내용은 서비스 개선 및 보안 정책 강화 등의 사유로 지속적으로 업데이트될 수 있으며, 개발 전 반드
시 최신 버전의 가이드를 확인할 것을 권장합니다. 규격 변경 시 기본적으로 하위 호환성을 유지하나, 예외 사항
이 있을 경우 본 문서 내에 별도로 명시합니다.
5 / 31

CNSPay Non-PG Module Manual
2. 환경설정 및 준비하기
2.1. 방화벽 및 time-out 설정
가맹점 환경에 따라 필요 시 아래 연결 대상으로 방화벽 오픈이 필요합니다.
용도 도메인 IP 포트 프로토콜 연결방향 (가맹점 기준)
인증/결제 pg.cnspay.co.kr 27.122.154.173 443 https OUTBOUND
가상계좌 결제수단을 사용 할 경우 가상계좌 입금통보 내역을 가맹점이 설정한 URL로 전달하게 됩니다.
필요 시, 아래 내용에 대해 방화벽 허용을 해 주시기 바랍니다.
용도 IP 포트 프로토콜 연결방향 (가맹점 기준)
가상계좌 121.50.22.77
443 https INBOUND
입금내역 전달 121.50.22.78
각 API 호출 시, Time-out 시간은 최소 20초 이상으로 설정해야 합니다.
응답 대기 시간이 짧게 설정될 경우 정상적인 결제 응답 수신이 불가능할 수 있으므로 반드시 확인이 필요합니다.
LG CNS에서 제공하는 모든 API는 HTTPS 프로토콜을 기반으로 동작합니다.
연동 시에는 반드시 HTTPS POST 방식으로 요청해야 하며, 아래의 HTTP 헤더 설정을 준수해야 합니다:
 Content-Type: application/json
 Charset: euc-kr
2.2. 보안 취약 프로토콜 허용 중지 및 업그레이드 적용 가이드
LG CNS는 전자결제 거래의 보안 강화를 위해, 보안이 취약한 TLS 1.2 미만 버전의 암호화 프로토콜에 대한 지원
을 중단하였습니다.
이에 따라, TLS 1.2 이상 버전만 접속이 허용되며, TLS 1.1 이하의 프로토콜을 사용하는 경우 CNSPay 시스템과의
네트워크 연결 자체가 차단되어 거래가 실패할 수 있습니다.
안정적인 연동을 위해 반드시 TLS 1.2 이상을 지원하는 환경으로 설정해 주시기 바라며, 관련 상세 내용은 아래
첨부된 가이드를 참고해 주시기 바랍니다.
 별첨.LG CNS 보안 취약 프로토콜 Upgrade 적용 가이드
2.3. 가상계좌 입금통보 기능 사용설정 및 가맹점 Source IP 등록 요청
6 / 31

CNSPay Non-PG Module Manual
입금통보 기능 사용 설정 및 가맹점정보 등록 안내
가맹점 계정이 최초 발급될 경우, 입금내역통보 기능은 기본적으로 미사용 상태로 설정되어 있습니다. 해당 기능
을 사용하기 위해서는 별도의 사용 신청 및 등록 절차를 거쳐야 합니다.
입금내역통보 기능 사용을 위해서는 다음 두 항목이 사전에 등록되어야 합니다:
 입금통보 수신용 URL
 가맹점 운영서버의 공인 IP (Source IP)
해당 정보는 아래 양식에 맞추어 작성한 후, CNSPay 기술지원을 통해 등록 요청해 주시기 바랍니다.
LG CNS 보안 정책에 따라, CNSPay 운영 서버의 방화벽에는 가맹점의 운영 서버 IP만 허용되며, 등록되지 않은 IP
는 접근이 차단됩니다.
또한, 해당 등록 요청은 자사 정기 배포 일정에 따라 반영되므로, 반드시 매주 화요일 오후 3시까지 신청을 완료
해 주시기 바랍니다. 이후 접수된 요청은 다음 배포 일정에 반영됩니다.
- CNSPay 기술지원: tech.cnspay@lgcns.com
신청 MID 입금통보 URL 허용 신청 IP 주소 포트
2.4. 서비스 이용 시 유의사항
- 본 가이드에 명시된 API 전문 규격은 기능 개선을 위해 사전 공지 없이 신규 파라미터가 추가될 수 있습니다.
- 추가되는 파라미터는 신규 버전의 규격서에 반영되며, 필요 시 해당 규격서를 가맹점에 별도로 전달해 드릴 예
정입니다.
- API 개발 시에는 JSON 응답 내에 정의된 필드 외에도 새로운 파라미터가 추가될 수 있음을 고려하여, 예기치
않은 항목이 포함되더라도 오류가 발생하지 않도록 유연한 구조로 응답을 처리할 수 있도록 개발해야 합니다.
(예: JSON 파싱 시 응답 항목을 Key 전체 매칭이 아닌, 필요한 필드만 추출하거나, 미정의 필드가 포함되어도
무시하도록 처리하는 방식으로 구현하는 것을 권장합니다.)
7 / 31

CNSPay Non-PG Module Manual
3. 결제 연동
결제 연동은 [거래초기화 → 인증 WebPage 연동 → 승인요청] 순서로 진행됩니다.
단, 가상계좌 결제의 경우 거래초기화 API 호출 이후, 인증 WebPage 연동 단계 없이 곧바로 승인요청 API를 사
용하여 연동하시면 됩니다.
거래초기화 값과 인증 WebPage 연동 값의 유효시간은 5분으로 설정되어 있으므로, 반드시 유효시간 내에 다음
단계로 연동을 완료해야 합니다.
CNSPay Non-PG 모듈은 PG사의 결제창이 사용자에게 노출되지 않는 구조이기 때문에, 전자결제에 대한 약관 동
의는 가맹점 측에서 사전에 처리하셔야 합니다.
관련 약관 내용은 LG CNS에서 별도 파일로 제공하며, 해당 내용을 주문 요청 이전 단계에서 '약관 동의' 항목으로
추가해 주시기 바랍니다.
또한, 본 문서에 기재된 Max Length는 모두 Byte 기준이며, 암복호화 필드에 대한 설정 방법은 별첨 문서를 참고
해 주시기 바랍니다.
8 / 31

CNSPay Non-PG Module Manual
3.1. 거래초기화
결제 연동을 위해서는 결제수단에 관계없이 반드시 거래초기화 절차를 선행해야 합니다.
거래초기화 요청에 대한 응답으로는 고유 거래 식별자인 TxnId 값이 반환되며, 이 값은 이후 인증 페이지 요청 및
승인 요청 시 필수 파라미터로 사용됩니다.
응답받은 TxnId 값의 유효기간은 5분이며, 해당 시간 내에 인증 또는 승인 요청이 이루어지지 않을 경우, 해당
TxnId는 만료되어 사용할 수 없습니다.
거래초기화 API URL
POST https://API Domain/cnspay/{version}/init
Request Header
항목 값 비고
Content-type applicaion/json
Request Body
Max
Parameter명 Type 필수여부 Description
Length
MID String 10 Y 가맹점 상점 ID
Moid String 40 Y 가맹점 자체 생성 주문번호 (반드시 유니크한 값으로 설정)
EdiDate String 14 Y 요청일시 (YYYYMMDDHH24MISS)
GoodsNm String 40 Y 결제상품명
Amt Number 12 Y 상품금액
거래 Validation Check 용도의 인증요청 Hash
a = Target String 생성 : EdiDate+MID+Amt
EncryptData String 100 Y
b = Sha256 SaltHash(a, MerchantKey) : 이 값을 설정
* 해쉬키 : 가맹점 계약 시 발급된 상점키(MerchantKey)
신용카드사별 인증창 사이즈 요청을 위한 카드사 코드
CardCd String 2 N
(문서 하단 카드코드표 참조)
Response
Parameter Max 필수
Type Description
명 Length 여부
ResultCd String 4 Y 응답코드 (성공:0000)
ResultMsg String 100 Y 응답메시지
TxnId String 16 Y 초기화ID
Moid String 30 Y 가맹점 주문번호
PrDt String 14 Y 초기화 처리일시 (YYYYMMDDHH24MISS)
Width String 3 N 창 너비 (요청 파라미터에 CardCd가 있을 경우 전달)
Height String 3 N 창 높이 (요청 파라미터에 CardCd가 있을 경우 전달)
9 / 31

CNSPay Non-PG Module Manual
3.2. 인증 Page 연동
거래초기화 호출 결과로 수신된 TxnId 값은 인증 Page 연동 시 필수로 사용되는 항목입니다.
고객의 접속 환경에 따라 인증 페이지는 다음과 같은 방식으로 동작합니다:
 PC 환경 : 팝업 방식 또는 레이어 방식
 Mobile 환경 : 레이어 방식
※ 단, 가상계좌 결제수단의 경우에는 인증 Page 연동 단계를 생략하고, 승인요청 API를 직접 호출하여 결제를 진
행하시면 됩니다. ([3.3. 결제 승인 요청] 항목 참고)
가맹점의 주문 페이지에서는, LG CNS에서 제공하는 아래의 스크립트 파일을 포함(include) 하여 인증 페이지 연동
기능을 구현해야 합니다.
JavaScript Include 설정 : 인증 Page 연동 호출 시 사용
<!-- cnspay javascript Library -->
<script type="text/javascript" src="<%=pgPath%>/dlpnonv2/cnspay_tr.js"></script>
인증 Page 호출, 결제 요청, 인증 취소 시 호출되는 Function 안내 및 Sample
아래는 위의 스크립트를 include하여 사용 시의 샘플 코드 입니다.
스크립트 내에서 아래 정의된 function을 호출하도록 구현되어 있는 부분이 있으니 참고하여 연동하시기 바랍니
다.
<script type="text/javascript">
//카드사 인증창 호출 sample function
function cnspay() {
var payMethod = document.getElementsByName('PayMethod')[0].value;
if (payMethod == 'CARD' || payMethod == 'NAVERPAY'
|| payMethod == 'KAKAOPAY' || payMethod == 'PAYCO') {
// 신용카드, 네이버페이, 카카오페이, 페이코 결제수단: 인증창 호출
goPay(payForm);
}else if(payMethod == 'VBANK'){
// 가상계좌 결제수단: 인증창 호출 없이 바로 승인 API 호출 구현
}
}
//최종 결제 요청하는 함수
//반드시 구현되어 있어야 함
function cnspaySubmit(message){
if(typeof(p_win) !== "undefined" && p_win != null) {
p_win.close();
}
//인증 이후 TrKey 파라미터의 경우 아래와 같이 전달 받을 수 있음
10 / 31

CNSPay Non-PG Module Manual
document.getElementsByName('TrKey')[0].value = message.TrKey;
//승인 API를 호출하도록 구현
}
//인증 취소 또는 실패 시 호출되는 함수
//해당 사유의 코드 및 메시지 수신 가능
//반드시 구현되어 있어야 함
function cnspayClose(message){
if(typeof(p_win) !== "undefined" && p_win != null) {
p_win.close();
}
if(typeof(message) === "undefined"){
alert("결제가 취소 되었습니다. 정의되지 않은 오류 발생");
}else{
if(typeof(message.ResultCd) === "undefined" || typeof(message.ResultMsg) === "undefined"){
alert("결제가 취소 되었습니다. 정의되지 않은 오류 발생");
}else{
alert("결제가 취소 되었습니다. [" + message.ResultCd + "] " + message.ResultMsg);
}
}
}
</script>
<body>
<form name="payForm" action="{결과페이지.jsp}" method="post">
// 중략...
<select name="PayMethod">
<option value="CARD">신용카드</option>
<option value="NAVERPAY">네이버페이</option>
<option value="KAKAOPAY">카카오페이</option>
<option value="PAYCO">페이코</option>
<option value="VBANK">가상계좌</option>
</select>
<input name="MID" type="text" value="{상점MID}" />
<input id="TxnId" name="TxnId" type="hidden" value="{거래초기화 이후 수신한 TxnId값}"/>
// 중략...
//카드사 인증창 노출방식 선택 (PC, 미적용시 기본 팝업)
<select name="UseLayerDlp">
<option value="N">팝업</option>
<option value="Y">레이어</option>
</select>
// 중략…
// 위 파라미터 이외에 인증창 오픈, 결제요청 시 필요한 파라미터를 form에 설정
11 / 31

CNSPay Non-PG Module Manual
</form>
</body>
레이어 팝업 호출 시 팝업창 사이즈 조절
<script type="text/javascript">
//레이어 팝업 호출 시 인증창 사이즈 자동 조절
function cnspay() {
var payForm = opener.document.payForm;
goPay(payForm);
var interval = window.setInterval(function(){
try {
if(typeof(this.cnsPopWidth) !== "undefined" && this.cnsPopWidth !=
null && typeof(this.cnsPopHeight) !== "undefined" && this.cnsPopHeight != null){
window.clearInterval(interval);
window.resizeTo(cnsPopWidth, cnsPopHeight);
//CNSPay에서 카드사별로 저장하고 있는 팝업창 사이즈 변수(cnsPopWidth:가로, cnsPopHeight:세로)
}
}catch(e){
}
}, 100);
}
</script>
Request : 결제수단 공통 항목
Max 필수
Parameter명 Type Description
Length 여부
TxnId String 16 Y 초기화ID (거래초기화 시 생성)
MID String 10 Y 가맹점 상점 ID
결제수단 코드
PayMethod String 10 Y 신용카드:CARD / 네이버페이:NAVERPAY
카카오페이:KAKAOPAY / 페이코:PAYCO
가맹점 주문번호
Moid String 40 Y
(거래초기화 시 사용했던 값 설정)
GoodsNm String 40 Y 상품명
Currency String 3 Y 기본값 'KRW' 설정
상품금액 (복합과세 가맹점의 경우 [공급가액+봉사료+부가세]의
Amt Number 12 Y
합과 일치해야 함)
SupplyAmt Number 12 N 공급가액 (복합 과세 가맹점의 경우 필수)
ServiceAmt Number 12 N 봉사료 (복합 과세 가맹점의 경우 필수)
GoodsVat Number 12 N 부가세 (복합 과세 가맹점의 경우 필수)
TaxationAmt Number 12 N 과세금액 (복합 과세 가맹점의 경우 필수)
주문자명 (AES256 암호화 : MerchantKey의 앞16byte 사용)
BuyerNm String 100
* 평문 기준 영문30자, 한글15자
BuyerTel String 100 주문자연락처 (AES256 암호화 : MerchantKey의 앞16byte 사용)
12 / 31

CNSPay Non-PG Module Manual
* 평문 기준 40자
주문자이메일 (AES256 암호화 : MerchantKey의 앞16byte 사용)
BuyerEmail String 100
* 평문 기준 60자
EdiDate String 14 Y 요청일시 (YYYYMMDDHH24MISS)
거래 Validation Check 용도의 인증요청 Hash
a = Target String 생성 : EdiDate+MID+Amt
EncryptData String 100 Y
b = Sha256 SaltHash(a, MerchantKey) : 이 값을 설정
* 해쉬키 : 가맹점 계약 시 발급된 상점키(MerchantKey)
DimType String 1 N 배경 Dim 처리 여부 (Null또는0:적용, 1:미적용)
Request : 신용카드 결제수단 추가 항목
Parameter명 Type Max Length 필수여부 Description
CardQuota String 2 Y 할부개월수 (예:02)
CardCd String 4 Y 인증요청 카드사 코드 (문서 하단 카드코드표 참조)
카드사포인트
CardPoint String 1 N
0:미사용, 1:포인트사용, 2:세이브포인트사용
CardInterest String 1 Y 가맹점 부담 무이자 여부 (0:일반, 1:무이자)
신한카드 결제선택 시 바로 신한카드 간편결제 실행 (Y:적용,
DirectSH String 1 N N:미적용)
*문서 하단 ’5.5.DirectSH적용 예시’ 참고
UseLayerDlp String 1 N 카드사 인증창 노출방식 (Y:레이어, Null 또는N:팝업)
Request : 네이버페이, 카카오페이, 페이코 결제수단 추가 항목
Parameter명 Type Max Length 필수여부 Description
UsedCardYn String 1 N 인증창 사용가능 카드사 설정 사용여부 (Y/N)
인증창 노출 카드사 코드 설정
- UsedCardYn 값이 ‘Y’일 경우 필수
UsedCard String 100 N - 여러 카드사 설정 시 01:02:04 와 같이 ‘:’ 기호로
구분해서 설정
- 문서 하단 카드코드표 참조
최대할부개월수
QuotaOpt String 2 N
- 예: 03 설정 시 인증창 내 4개월 이상 할부 선택 불가
고정할부개월수 (예:02)
Quota String 2 N
(QuotaOptAddYn과 중복 사용 시 우선순위)
부분할부개월수 사용여부 (Y/N)
QuotaOptAddYn String 1 N 요청 시 선택카드사의 선택한 할부개월수만 노출됨
(Quota와 중복 사용 시 후순위)
부분할부개월수 (부분할부개월수 사용여부가 ‘Y’일 경우
QuotaOptAdd String 200 N 필수)
카드코드-할부개월(예:01-02:03:06,04-03:06)
UseNaverPointYn String 1 N 네이버포인트 사용여부 (Y/N)
현금영수증 용도구분 (네이버페이 포인트 사용 시 설정)
CashReceiptType String 1 N - 0:미발행, 1:소득공제, 2:지출증빙
(0으로 요청시 현금영수증 발행 안함)
13 / 31

CNSPay Non-PG Module Manual
현금영수증 발급번호 (네이버페이 포인트 사용 시 설정)
CashReceiptType(용도구분) 값에 따라 휴대폰번호,
사업자번호 설정
ReceiptTypeNo String 100 N
- 소득공제 : 휴대폰번호
- 지출증빙 : 휴대폰번호 or 사업자번호
(AES256 암호화하여 설정 : MerchantKey의 앞16byte 사용)
Response
Max
Parameter명 Type 필수여부 Description
Length
ResultCd String 4 Y 응답코드 (성공:0000)
ResultMsg String 100 Y 응답메시지
TrKey String 30 Y 인증결과 Key
3.3. 결제 승인 요청
가맹점은 인증 완료 후 전달받은 인증결과Key를 결제 승인 요청 API에 설정하여 승인을 요청합니다.
인증결과Key 값은 인증 요청 후 5분 동안만 유효합니다.
결제 승인 요청 API URL
POST https://API Domain/cnspay/{version}/approve
Request Header
항목 값 비고
Content-type applicaion/json
Request Body : 결제수단 공통 항목
Max 필수
Parameter명 Type Description
Length 여부
결제수단 코드
신용카드:CARD / 네이버페이:NAVERPAY
PayMethod String 10 Y
카카오페이:KAKAOPAY / 페이코:PAYCO
가상계좌:VBANK
GoodsCnt String 2 Y 결제상품개수 (디폴트 값 1로 세팅)
상품명
(결제상품명 중
GoodsNm String 40 Y
“|” → "-“
“<”→ “[“
14 / 31

CNSPay Non-PG Module Manual
“>"→ “]"
으로 자동 치환됩니다.)
상품금액 (복합 과세 가맹점의 경우
Amt Number 12 Y
[공급가액+봉사료+부가세]의 합과 일치해야함)
SupplyAmt Number 12 N 공급가액 (복합 과세 가맹점의 경우 필수)
ServiceAmt Number 12 N 봉사료 (복합 과세 가맹점의 경우 필수)
GoodsVat Number 12 N 부가세 (복합 과세 가맹점의 경우 필수)
TaxationAmt Number 12 N 과세금액 (복합 과세 가맹점의 경우 필수)
MID String 10 Y 가맹점 상점 ID
주문자명 (AES256 암호화 : MerchantKey의 앞16byte 사용)
BuyerNm String 100
* 평문 기준 영문30자, 한글15자
주문자연락처 (AES256 암호화 : MerchantKey의 앞16byte
BuyerTel String 100 사용)
* 평문 기준 40자
주문자이메일 (AES256 암호화 : MerchantKey의 앞16byte
BuyerEmail String 100 사용)
* 평문 기준 60자
EdiDate String 14 Y 결제 승인 요청일시 (YYYYYMMDDHH24MISS)
거래 위변조 Validation Check 용도의 인증요청 Hash
a. Target String 생성 : EdiDate+MID+Amt
EncryptData String 200 Y
b. Sha256 SaltHash(a, MerchantKey) : 이 값을 설정
* 해쉬키 : 가맹점 계약 시 발급된 상점키(MerchantKey)
가맹점 주문번호
Moid String 40 Y
(거래초기화 시 사용했던 값 설정)
Currency String 3 Y 기본값 'KRW' 설정
TxnId String 16 Y 초기화ID (거래초기화 시 생성)
인증결과 Key
TrKey String 30 Y
(가상계좌 외 필수)
Request Body : 가상계좌 결제수단 추가 항목
Max 필수
Parameter명 Type Description
Length 여부
VbankBankCd String 3 Y 가상계좌 발급은행코드 (문서 하단 가상계좌 은행코드 참조)
가상계좌 입금만료일시 : 8자리 또는 12자리
VbankExpDate String 14 Y (ex : 20220315, 202203151530)
이 일시가 지나면 가상계좌 입금 불가
수취인명 (AES256 암호화 : MerchantKey의 앞16byte 사용)
고객이 가상계좌 입금 시 보여지는 입금계좌 수취인명의 가맹점
상호 또는 서비스명 설정값
VbankAccountNm String 100 N * 미설정 시 계약된 상호명으로 자동 설정
* 수취인명의 고객명은 BuyerNm으로 자동 설정
Ex) 계약시 상호: xx학원 -> 미설정 시 고객A 화면:
xx학원(고객A)
15 / 31

CNSPay Non-PG Module Manual
가맹점 설정값: xx학원B반 -> 고객A 화면:
xx학원B반(고객A)
Request Body : 현금영수증 추가 항목
현금영수증의 경우 가상계좌 결제수단 요청 시 사용 가능합니다.
가상계좌 현금영수증 발급의 경우 고객이 가상계좌번호로 입금을 한 이후 진행되며, 가맹점에 입금 내역 통보 시
에 현금영수증 발급정보를 함께 전달합니다.
위 내용은 [3.6. 가상계좌 입금통보] 메뉴를 참조하시기 바랍니다.
Max 필수
Parameter명 Type Description
Length 여부
현금영수증 용도구분 (가상계좌 사용 시 전달)
CashReceiptType String 1 N - 0:미발행, 1:소득공제, 2:지출증빙
(0으로 요청시 현금영수증 발행 안함)
현금영수증 발급번호 (가상계좌 사용 시 전달)
CashReceiptType(용도구분) 값에 따라 휴대폰번호, 사업자번호
설정
ReceiptTypeNo String 100 N
(소득공제 : 휴대폰번호 / 지출증빙 : 휴대폰번호 or
사업자번호)
(AES256 암호화 : MerchantKey의 앞16byte 사용)
Response : 결제수단 공통 항목
Max 필수
Parameter명 Type Description
Length 여부
정상 : 0000
결제완료 후 결과에 대한 결과 값
정상 승인이 이루어졌을 경우 아래와 같이 결제수단별 성공코드
값이 리턴.
ResultCd String 4 Y
그 외에 오류가 발생했을 경우에는 오류코드가 리턴 됩니다.
결과 페이지에서 DB처리를 할 경우 ResultCd를 이용하시기
바랍니다.
Ex) 8999
결제 요청 결과에 대한 메시지 값
‘정상처리’ 외의 실패 건에 대해서는 ResultCd에 해당하는 오류
ResultMsg String 100 Y
사유가 리턴 됩니다.
Ex) 기타오류
거래를 구분하는 Transaction ID
TID String 30 Y
예) cnstest30m01012112060000001234
Moid String 30 Y 가맹점에서 부여한 거래 주문번호
MID String 10 Y 가맹점 상점 ID
결제수단
PayMethod String 4 Y
(신용카드: CARD, 가상계좌: VBANK)
Amt Number 12 Y 승인금액 (숫자만 입력, 콤마 등 문자열 제외)
16 / 31

CNSPay Non-PG Module Manual
결제 승인 일시 (YYMMDDHH24MISS)
AuthDate String 12 Y
(예 : 220315233055)
AuthCd String 30 Y 승인번호 (가상계좌 외 결제수단)
BuyerNm String 100 주문자명 (AES256 암호화 : MerchantKey의 앞16byte 사용)
부분취소 가능여부
CcPartCl String 1 N
0:부분취소불가 / 1:부분취소가능
Response : 신용카드 결제수단 추가 항목
Max 필수
Parameter명 Type Description
Length 여부
신용카드사별 코드
CardCd String 3 Y
(문서 하단 카드코드 항목 참조)
CardNm String 20 Y 결제카드사명 (예:비씨)
할부 결제 시 주문자가 선택한 할부 개월
CardQuota String 2 Y
Ex) 3개월의 경우 : 03, 일시불의 경우 : 00
CardBin String 8 Y 카드 BIN번호
승인VAN 코드
VanCd String 2 Y 01(나이스), 04(코밴), 05(스마트로), 06(신한직승인),
07(다우), 10(2차PG)
카드사포인트
CardPoint String 1 Y
0:미사용, 1:포인트사용, 2:세이브포인트사용
CardInterest String 1 Y 무이자 여부 (0:일반, 1:무이자)
CardNo String 20 N 카드번호 (일부구간 마스킹(*) 처리하여 전달)
CardCl String 1 N 체크카드여부 (0: 일반, 1: 체크카드)
ISP 계열 카드 발급사 코드
IspBankCd String 4 N
(문서 하단 ‘ISP 거래 카드 세부 발급사 코드’ 참조)
IspBankNm String 32 N ISP 계열 카드 발급사 명
CardType String 2 N 카드구분 (01: 개인, 02: 법인, 04: 개인+법인)
Response : 가상계좌 결제수단 추가 항목
Max 필수
Parameter명 Type Description
Length 여부
가상계좌 은행코드
VbankBankCd String 3 Y
(문서 하단 은행코드 항목 참조)
가상계좌 은행
VbankBankNm String 20 Y
Ex) 국민은행
가상 계좌번호
가상계좌 입금계좌 번호입니다. 결제자는 이 계좌번호를
VbankNum String 20 Y 부여 받게 되고, 이 계좌번호에 대해 기한 내에 입금을
하면 결제가 완료됩니다.
Ex) 30924111222
가상계좌 입금만료 예정일자 (YYYYMMDD)
VbankExpDate String 8 N
(예 : 20221020)
17 / 31

CNSPay Non-PG Module Manual
가상계좌 입금만료 예정시간 (HHMISS)
VbankExpTime String 6 Y
(예 : 235959)
Response : 네이버페이, 카카오페이, 페이코 결제수단 추가 항목
필수
Parameter명 Type Max Length Description
여부
신용카드사별 코드
CardCd String 3 Y
(문서 하단 카드코드 항목 참조)
CardNm String 20 Y 결제카드사명 (예:비씨)
할부 결제 시 주문자가 선택한 할부 개월
CardQuota String 2 Y
Ex) 3개월의 경우 : 03, 일시불의 경우 : 00
CardBin String 8 Y 카드 BIN번호
카드사포인트 사용여부
CardPoint String 1 Y
0:미사용, 1:포인트사용, 2:세이브포인트사용
CardType String 2 N 카드구분 (01: 개인, 02: 법인, 04: 개인+법인)
CardInterest String 1 N 무이자 여부 (0:일반, 1:무이자)
무이자 이벤트 구분 (카드사무이자 : CARD /
CardInterestType String 4 N
가맹점무이자 : SHOP)
CardCl String 1 N 체크카드여부 (0: 일반, 1: 체크카드)
ISP 계열 카드 발급사 코드
IspBankCd String 4 N
(문서 하단 ‘ISP 거래 카드 세부 발급사 코드’ 참조)
IspBankNm String 32 N ISP 계열 카드 발급사 명
페이포인트 결제금액
- 네이버페이 : 네이버포인트
PointAmt Number 12 N
- 카카오페이 : 카카오머니
- 페이코 : 페이코포인트
주결제수단 코드
- 네이버페이 : 신용카드(C), 계좌이체(B),
네이버포인트(P)
DetailMethod String 2 N - 카카오페이 : 신용카드(C), 카카오머니(M)
- 페이코 : 신용카드(C), 페이코포인트(P)
(단, 네이버포인트, 카카오머니, 페이코포인트 코드의
경우 해당 결제수단으로 전액 결제한 경우에 전달됨)
현금영수증 발행대상 결제금액
CashReceiptAmt Number 12 N
(네이버페이/카카오페이)
BankCd String 2 N 계좌이체 시 은행코드
BankNm String 20 N 계좌이체 시 은행명
BankNo String 20 N 계좌이체 시 마스킹된 계좌번호
DiscountAmt Number 12 N 페이코 쿠폰 할인금액
3.4. 결제 취소 요청
결제 취소 요청 API URL
18 / 31

CNSPay Non-PG Module Manual
POST https://API Domain/cnspay/{version}/cancel
Request Header
항목 값 비고
Content-type applicaion/json
Request Body : 결제수단 공통 항목
Max 필수
Parameter명 Type Description
Length 여부
MID String 10 Y 가맹점 상점 ID
승인 응답으로 받은 거래 구분 Transaction ID
TID String 30 Y
예 ) cnstest30m01012112060000001234
취소금액 (복합 과세 가맹점의 경우
CancelAmt Number 12 Y
[공급가액+봉사료+부가세]의 합과 일치해야함)
SupplyAmt Number 12 N 공급가액 (복합과세 가맹점의 경우 연동FAQ 참조)
ServiceAmt Number 12 N 봉사료 (복합과세 가맹점의 경우 연동FAQ 참조)
GoodsVat Number 12 N 부가세 (복합과세 가맹점의 경우 연동FAQ 참조)
TaxationAmt Number 12 N 과세금액 (복합과세 가맹점의 경우 연동FAQ 참조)
거래 위변조 Validation Check 용도의 인증요청 Hash
a. Target String 생성 : EdiDate + MID + CancelAmt
EncryptData String 200 Y
b. Sha256 SaltHash(a, MerchantKey) : 이 값을 설정
* 해쉬키 : 가맹점 계약 시 발급된 상점키(MerchantKey)
EdiDate String 14 Y 결제 취소 요청일시 (YYYYMMDDHH24MISS)
CancelMsg String 100 Y 취소사유
CancelIP String 15 N 취소요청자 IP
PartialCancelCd String 1 Y 부분취소 구분코드 (0:전체취소, 1:부분취소)
*부분취소 시 필수
부분취소번호 : 가맹점 관리용 또는 거래상태 조회 시 사용됨.
다중 부분취소 처리 시 중복취소를 방지하기 위해 하나의
CancelNo Number 4 Y 원거래 ID에 대한 부분취소번호는 중복되지 않아야 하며,
반드시 0 보다 큰 정수값으로 설정해야 함
예) 첫 번째 부분취소번호: 1,
두 번째 부분취소번호: 2….
부분취소 이전 남은 잔액
CheckRemainAmt Number 12 N (가맹점이 요청한 잔액과 CNSPay의 잔액이 상이하면 취소 실패
처리)
Request Body : 가상계좌 결제수단 추가 항목
Max
Parameter명 Type 필수여부 Description
Length
(고객 입금 후 환불 요청 시 필수)
RefundBankCd String 3 Y
환불요청 은행코드
19 / 31

CNSPay Non-PG Module Manual
(고객 입금 후 환불 요청 시 필수)
RefundAcctNo String 100 Y 환불받을 계좌번호
(AES256 암호화 : MerchantKey의 앞16byte 사용)
(고객 입금 후 환불 요청 시 필수)
RefundAcctNm String 100 Y 환불받을 계좌 예금주명
(AES256 암호화 : MerchantKey의 앞16byte 사용)
Reponse : 결제수단 공통 항목
Max
Parameter명 Type 필수여부 Description
Length
취소완료 여부에 대한 응답 값
ResultCd String 10 Y
정상: 0000(취소성공), 그 외 에러
취소 요청 결과에 대한 메시지 값
실패 건에 대해서는 응답 코드값에 해당하는 오류
ResultMsg String 100 Y
응답 메시지를 리턴 합니다.
Ex) 정상처리
ErrorCd String 5 N 에러코드
ErrorMsg String 100 N 에러메시지
CancelAmt Number 12 Y 취소금액
CancelDate String 8 Y 취소일자 (YYYYMMDD)
CancelTime String 6 Y 취소시간 (HH24MISS)
취소결제수단
PayMethod String 10 Y
(신용카드: CARD, 가상계좌: VBANK)
MID String 10 Y 가맹점 상점 ID
거래 Transaction ID
TID String 30 Y
예) cnstest30m01012112060000001234
거래상태코드
StateCd String 1 Y
0:승인, 1:전취소, 2:후취소
Reponse : 네이버페이, 카카오페이, 페이코 추가 항목
Parameter명 Type Max Length 필수여부 Description
주결제수단 코드
- 네이버페이 : 신용카드(C), 계좌이체(B),
네이버포인트(P)
DetailMethod String 2 N - 카카오페이 : 신용카드(C), 카카오머니(M)
- 페이코 : 신용카드(C), 페이코포인트(P)
(단, 네이버포인트, 카카오머니, 페이코포인트 코드의 경우
해당 결제수단으로 전액 결제한 경우에 전달됨)
페이포인트 취소금액
- 네이버페이 : 네이버포인트
PointAmt Number 12 N
- 카카오페이 : 카카오머니
- 페이코 : 페이코포인트
현금영수증 취소대상 결제금액
CashReceiptAmt Number 12 N
(네이버페이/카카오페이)
DiscountAmt Number 12 N 페이코 쿠폰 할인금액
20 / 31

CNSPay Non-PG Module Manual
(-1 로 전달될 경우 ‘취소 진행중’ 상태이므로 [3.5.
거래상태 조회 요청]을 통해 PointAmt와 DiscountAmt 값을
확인해야 함)
3.5. 거래상태 조회 요청
거래상태 조회 요청 API URL
POST https://API Domain/cnspay/{version}/transInfo
거래상태 조회 요청을 통해 거래건의 현재 상태 확인이 가능합니다. 거래 초기화 시 전달해드린 TxnId 값으로 조
회를 하게 되며, 승인 및 취소 거래 정보를 확인할 수 있습니다.
가맹점에서는 승인 요청 API 호출 시 Timeout 등의 통신 에러가 발생된 경우, 실제로 승인이 발생되었는지에 대
한 확인을 위해 해당 거래 건의 상태 조회가 필요합니다. 승인 상태로 확인될 경우 취소요청 API를 호출하는 방
식으로 사용이 가능합니다.
Request Header
항목 값 비고
Content-type applicaion/json
Request Body
Max
Parameter명 Type 필수여부 Description
Length
MID String 10 Y 가맹점 상점 ID
TxnId String 16 Y 초기화ID
EdiDate String 14 Y 전문생성일시 (YYYYMMDDHH24MISS)
거래 위변조 Validation Check 용도의 인증요청 Hash
a. Target String 생성 : EdiDate+MID+TxnId
EncryptData String 200 Y b. Sha256 SaltHash(a, MerchantKey)
* 해쉬키 : 가맹점 계약 시 발급된
상점키(MerchantKey)
Response
Max 필수
Parameter명 Type Description
Length 여부
Result Object 상태조회 공통 정보
조회결과코드
ResultCd String 10 Y
정상: 0000, 그 외 에러
21 / 31

CNSPay Non-PG Module Manual
ResultMsg String 100 Y 조회 결과 메시지
MID String 10 Y 가맹점 상점 ID
거래번호/거래를 구분하는 원거래 transaction ID
TID String 30 Y
예) cnstest30m01012112060000001234
Moid String 30 Y 가맹점에서 부여한 거래 주문번호
거래상태코드
- 신용카드 : [0:승인, 1:전체취소, 2:부분취소]
StateCd String 1 Y
- 가상계좌 : [0:입금완료, 1:환불, 3:채번(입금요청),
4:채번취소]
AppAmt Number 12 Y 승인 금액
CanAmt Number 12 Y 취소 금액
RemainAmt Number 12 Y 남은 승인 금액
결제수단 코드
신용카드:CARD / 네이버페이:NAVERPAY
PayMethod String 4 Y
카카오페이:KAKAOPAY / 페이코:PAYCO
가상계좌:VBANK
AppResult Object 원 승인거래의 승인 정보 전달
승인 일시 (YYYYMMDDHH24MISS)
AppDate String 14 Y
(가상계좌 0:입금완료 상태의 경우 입금일시 전달)
승인 시 포인트 사용금액 (네이버페이, 카카오페이,
AppPointAmt Number 12 N
페이코)
AppDiscountAmt Number 12 N 승인 시 쿠폰 할인금액 (페이코)
승인 시 현금영수증 발행대상 금액
CashReceiptAmt Number 12 N
(네이버페이/카카오페이)
주결제수단 코드 (네이버페이, 카카오페이, 페이코)
- 네이버페이 : 신용카드(C), 계좌이체(B),
네이버포인트(P)
DetailMethod String 2 N - 카카오페이 : 신용카드(C), 카카오머니(M)
- 페이코 : 신용카드(C), 페이코포인트(P)
(단, 네이버포인트, 카카오머니, 페이코포인트 코드의
경우 해당 결제수단으로 전액 결제한 경우에 전달됨)
StateCd 가 1(전체취소), 2(부분취소) 상태일 때 전달
Object
CanResult 취소의 경우 건수만큼 Array 형태로 전달
(Array)
(가상계좌의 경우 4(채번취소) 상태 시에도 전달)
CanAmt Number 12 Y 취소 금액
CanDate String 14 Y 취소 일시 (YYYYMMDDHH24MISS)
CancelNo Number 4 N 부분취소 시 설정한 취소번호
- 전체취소시는 원거래 TID
TID String 30 Y
- 부분취소시는 취소 성공 시 응답한 TID
취소 시 포인트 취소금액
CanPointAmt Number 12 N
(네이버페이, 카카오페이, 페이코)
CanDiscountAmt Number 12 N 취소 시 쿠폰 취소금액 (페이코)
취소 시 현금영수증 취소대상 금액
CashReceiptAmt Number 12 N
(네이버페이/카카오페이)
22 / 31

CNSPay Non-PG Module Manual
3.6. 가상계좌 입금통보
가상계좌 발급 거래 건에 대해 고객이 입금을 할 경우 CNSPay에서 가맹점으로 해당 입금 내역을 전달하는 규격
입니다. 가맹점은 CNSPay측으로 사전에 입금 통보를 받을 페이지의 등록 요청이 필요하며, 입금 통보 전문 수신
시 해당 주문을 입금상태로 변경하여 처리하시면 됩니다.
입금 통보 전문 수신 시 아래 정의된 응답전문 규격에 맞춰 응답처리가 되어야 합니다. 정상 응답이 수신되지 않
을 경우 입금 재통보가 이루어지게 됩니다.
가상계좌 입금통보 Request Header
항목 값 비고
Content-type applicaion/json
가상계좌 입금통보 Request Body
데이터 데이터
파라미터명 파라미터설명 설명
타입 길이
TID 거래 ID String 30 거래 ID
MID 가맹점 ID String 10 가맹점 ID
MOID 가맹점 주문번호 String 40 가맹점 주문번호
APP_REQ_DT 채번일자 String 8 채번일자
APP_REQ_TM 채번시간 String 6 채번시간
REQ_AMT 채번금액(주문금액) String 14 채번금액(주문금액)
GOODS_AMT 입금액 Number 14 입금액
BANK_CD 가상계좌 은행코드 String 3 문서 하단 [5.3. 은행코드] 참조
BANK_NM 가상계좌 은행명 String 50 가상계좌 은행명
VACCT_NO 가상계좌번호 String 20 가상계좌번호
GOODS_NM 상품명 String 200 상품명
MALL_USER_ID 가맹점ID String 20 가맹점ID
MALL_RESERVED 가맹점 사용필드 String 500 가맹점 사용필드
입금일자 (입금통보 없이 채번한 한
APP_DT 입금일자 String 8
경우라면 app_dt 값이 없다.)
APP_TM 입금시간 String 6 입금시간
INPUT_ACCT_NM 입금자명 String 40 고객 입금 시 설정한 입금자명
RCPT_TID 현금영수증 TID String 30 현금영수증 ID
RCPT_CD 현금영수증 타입 String 1 0:미발행, 1:소득공제, 2:지출증빙
현금영수증 용도구분에 따라 휴대폰 번호
RCPT_TYPE_NO 현금영수증 발급번호 String 20 또는 사업자번호 (개인정보 보호로
마스킹처리 후 전송)
RCPT_AUTH_CODE 현금영수증 승인번호 String 30
RSLT_CD 처리코드 String 4 처리코드
RSLT_MSG 처리메시지 String 80 처리메시지
23 / 31

CNSPay Non-PG Module Manual
전문 암호화 처리
가상계좌 입금통보 시 일부 개인정보가 포함되어 있으므로 아래와 같이 해당 내역을 암호화하여 가맹점에 전달
합니다.
// 전문 바디
{"MOID":"mnoid1234567890","APP_REQ_DT":"20160202","APP_REQ_TM":"154356","MID":"cnstest00m","REQ_AMT":10
00,"GOODS_AMT":1000,"BANK_CD":"088","BANK_NM":"신한은행","VACCT_NO":"08800000000276","GOODS_NM":"가상계
좌33","APP_DT":"20160202","APP_TM":"20160202","RSLT_CD":"VB00","RSLT_MSG":"정상",”RCPT_TYPE”:”1”,”RCPT_
AUTH_CODE”:”G12345678”,”RCPT_TID”:”cnstest30m04012108051549124990”,”RCPT_TYPE_NO”:”01012345678” }
// 전문 암호화 예시
https://dev.cnspay.co.kr:6464/dlp/sample/vbankNotiURLProcess.jsp?{"TID":"cnstest00m03011602021544470970
","BODY":"R+xnjloC1pSYFw44wj0QkYy3zm99xFh4qxQ4j4sDPdKBewX+HH5dDyVniRd6CBHjpwvGvyOg70COQvqBsKWNXqmmQcSFL
hS5/BOiyQwhry9D4051tw71vK/jpbKEOvzmeYpUVtqhSQPmbOWX14thxthIdXUy1vOS84EGYVR/zbJI2sTh/Znrb04SmiiawhuUw8EO
bn4LvxlbjJqJqvyEch1ZkOXFLt+QZccGtS8FWudim4GecORNguGr+fochhLEPxRoL11Bo5NmilHQCpul0OuQsohiSHMx6QZQ6la1urp
LdI3mYyOYXa6ptX0ChHkKixL1bk027MvZOHPE6LuQ/a5AatIKh4L5WR/6vD/cEWRUTB8LRoz5D7I1pPZlZNaZ0D435V/f+VZKtVpW76
XJkQ=="}
// URL의 경우, 통보 받으실 가맹점의 URL을 CNSPay측으로 알려주시면 반영해드립니다.
필드 복호화 처리
가맹점에서는 위의 암호화 처리된 내역을 복호화해서 사용하셔야 합니다.
- 암호화 키는 상점키의 앞에서 16byte 처리
- 복호화 예시
MerchantCipher mCipher = new MerchantCipher();
String decryptReq = mCipher.parameterDecrypt(가맹점 상점키 16byte, 암호화된 수신정보);
위 복호화 시 사용하는 function의 경우 별첨 문서로 전달해드리는 아래 문서를 참조하시기 바랍니다.
- 별첨_CNSPay_Non-PG_암복호화_샘플_v1.0.pdf
가상계좌 입금통보 Response Body
데이터
파라미터명 파라미터설명 데이터 길이 설명
타입
TID 거래 ID String 30 거래 ID
RSLT_CD 처리코드 String 4 결과코드
RSLT_MSG 처리메시지 String 80 결과메시지
※ 응답정보는 위의 값들을 JSON 형태로 전달
응답전문 예시
24 / 31

CNSPay Non-PG Module Manual
{"TID":"cnstest00m03011606171020401130","RSLT_CD":"VB00","RSLT_MSG":"정상"}
가상계좌 입금 통보 시 결과 코드
결과코드 메시지 내용
VB00 정상
VB01 기 처리된 건
VB02 해당 거래 건 아님
VB98 복호화 실패
VB99 기타
25 / 31

CNSPay Non-PG Module Manual
4. 결제 및 취소 테스트 시 주의사항
결제 및 취소 테스트를 위해 제공해드리는 테스트 가맹점 계정(MID: cnstest**m)은 현재 모든 가맹점에 동일하게
제공되고 있는 공용 계정입니다. 타 가맹점의 데이터가 유실되는 것을 방지하기 위해서 긴급상황 외에는 테스트
계정의 CNSPay 가맹관리시스템(https://mms.cnspay.co.kr) 서비스 이용이 제한되는 점 양해 부탁드립니다.
해당 MID로 발생된 거래는 카드사에서 실제 청구하지 않는 거래이니 안심하시기 바랍니다. 단, 실제 결제와 같이
카드사 문자가 발송되며, 체크카드 결제 시에는 실제 출금 이후 취소 시에 다시 입금되니 참고 바랍니다.
4.1 결제 테스트 시 주의사항
1) 일반 가맹점
- 가맹점 개발/테스트시에는 테스트용 MID인 cnstest30m를 사용하시면 됩니다.
- 결제/취소 금액 설정 시, 일반 가맹점은 총 결제금액만 세팅하시면 됩니다.
2) 복합과세 가맹점
- 복합과세를 사용하시는 가맹점에서는 복합과세에 대한 테스트용 MID인 cnstest39m을 이용하여 연동 개발
및 테스트 수행하시면 됩니다.
- 결제/취소 금액 설정 시, 복합과세 가맹점은 공급가액(SupplyAmt), 부가세(GoodsVat), 봉사료(ServiceAmt), 과
세금액(TaxationAmt) 파라미터를 가맹점에서 세팅해 주어야 합니다.
3) 네이버페이, 카카오페이 결제 테스트
- 네이버페이, 카카오페이 결제수단의 경우 개발서버 테스트시에도 실 결제가 수행되며, 보유한 실 계정으로 테
스트를 진행해야 합니다.
- 테스트 후 취소 처리하시기 바랍니다.
4.2 취소 테스트 시 주의사항
테스트용 MID(cnstest**m)로 결제한 거래건에 대해서는 별도로 취소 처리를 하지 않아도 매시각 30분경 자동
취소됩니다. 다만 카드 한도에는 포함될 수 있으니 고액 결제 테스트 시 주의하시기 바랍니다.
부분취소의 경우 테스트 MID로 테스트를 실시하여도 일반 전체 취소와는 다르게 실제 카드사 매입 진행됩니다.
단, 취소매입이 동시에 이루어지므로 실제 청구되는 금액은 없습니다. 해당 과정으로 인해 부분 취소 완료 처리에
는 3~4일 정도 소요 되오니 테스트시 참고하시기 바랍니다
26 / 31

CNSPay Non-PG Module Manual
5. 참고자료
5.1. 모바일 앱 연동 관련 안내
안드로이드
Android 11(30) 버전부터 연동할 앱에 Package 정보가 AndroidManifest.xml 에 명시가 되어있어야만 해당 앱으
로 이동이 가능합니다.
아래 빨간색으로 표시된 내용이 추가 되어야 합니다.
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.lgcns.myapplication">
<uses-permission android:name="android.permission.INTERNET" />
<application
android:usesCleartextTraffic="true"
android:allowBackup="true"
android:icon="@mipmap/ic_launcher"
android:label="@string/app_name"
android:roundIcon="@mipmap/ic_launcher_round"
android:supportsRtl="true"
android:theme="@style/Theme.MyApplication">
<activity android:name=".MainActivity">
<intent-filter>
<action android:name="android.intent.action.MAIN" />
<category android:name="android.intent.category.LAUNCHER" />
</intent-filter>
</activity>
</application>
<queries>
<package android:name="com.ahnlab.v3mobileplus" />
<package android:name="kr.co.shiftworks.vguardweb" />
<package android:name="com.kftc.bankpay.android" />
<package android:name="com.TouchEn.mVaccine.webs" />
<package android:name="com.lottemembers.android" />
<package android:name="com.lotte.lpay" />
<package android:name="com.samsung.android.spay" />
<package android:name="com.kakao.talk" />
<package android:name="com.ssg.serviceapp.android.egiftcertificate" />
<package android:name="com.nhnent.payapp" />
<package android:name="com.wooricard.smartapp" />
<package android:name="com.wooricard.wpay" />
27 / 31

CNSPay Non-PG Module Manual
<package android:name="kr.co.citibank.citimobile" />
<package android:name="com.hanaskcard.paycla" />
<package android:name="com.lcacApp" />
<package android:name="kvp.jjy.MispAndroid320" />
<package android:name="com.kbcard.cxh.appcard" />
<package android:name="nh.smart.nhallonepay" />
<package android:name="kr.co.samsungcard.mpocket" />
<package android:name="com.hyundaicard.appcard" />
<package android:name="com.shcard.smartpay" />
<package android:name="com.nhn.android.search" />
<package android:name="viva.republica.toss" />
<package android:name="com.samsung.android.spaylite" />
<package android:name="com.lge.lgpay" />
<package android:name="com.shinhancard.smartshinhan" />
<package android:name="com.lumensoft.touchenappfree" />
<package android:name="com.kbstar.liivbank" />
<package android:name="com.kbstar.reboot" />
<package android:name="kr.co.hanamembers.hmscustomer" />
<package android:name="com.wooribank.smart.npib" />
<package android:name="com.shinhan.smartcaremgr" />
<package android:name="net.ib.android.smcard" />
</queries>
</manifest>
좀 더 자세한 내용은 아래 첨부한 링크를 참조하시기 바라며, 현행화된 Package명 리스트는 ‘별첨.Android패키지
명 및 iOS앱스키마 리스트’ 파일을 참고 바랍니다
https://developer.android.com/training/basics/intents/package-visibility?hl=ko
iOS
iOS9부터 보안을 강화하는 목적으로 앱을 호출할 때 앱스키마 리스트를 등록해주어야 합니다.
카드사에서 사용하는 앱의 리스트가 추가될 경우 리스트 업데이트가 필요합니다.
등록하지 않을 경우 해당 앱이 호출되지 않을 수 있으며, 현행화된 앱스키마 리스트는 ‘별첨.Android패키지명 및
iOS앱스키마 리스트’ 파일을 참고 바랍니다
Info.plist 파일에 LSApplicationQueriesSchemes 배열을 정의하여 앱 스키마 리스트를 등록합니다.
(1) Information Property List에 LSApplicationQueriesSchemes를 Array 타입으로 추가
(2) LSApplicationQueriesSchemes 하위 리스트에 String 타입으로 Item 추가
(3) Item 마다 앱 스키마를 입력
5.2. 신용카드 코드
코드 카드사
01 비씨
02 KB국민
28 / 31

CNSPay Non-PG Module Manual
03 하나Pay
04 삼성
06 신한
07 현대
08 롯데
11 씨티
12 농협(NH페이)
13 수협
14 신협
15 우리
21 광주
22 전북
23 제주
32 우체국
33 저축은행
35 새마을금고
36 KDB산업
37 KB증권
38 카카오뱅크
39 기업BC
58 케이뱅크
5.3. ISP 거래 카드 세부 발급사 코드
ISP 인증방식을 통한 BC카드 거래의 경우 아래와 같은 세부 카드 발급사가 존재합니다.
위 가이드 내 [3.3. 결제 승인 요청- Response : 신용카드 결제수단 추가 항목- IspBankCd] 항목으로 전달되는 값
이니 참고하시기 바랍니다.
은행코드 은행명
002 산업은행
003 기업은행
006 국민은행
007 수협은행
011 농협중앙회
012 단위농협
012 농협농촌사랑
014 조합농촌사랑
020 우리은행
021 신한은행
023 SC제일은행
025 하나은행
027 씨티은행
031 iM 뱅크(대구)
032 부산은행
033 하나SK
29 / 31

CNSPay Non-PG Module Manual
034 광주은행
035 제주은행
036 씨티은행
037 전북은행
039 경남은행
041 동부증권
043 우리은행pay
045 새마을금고연합회
048 신협중앙회
050 비씨카드
051 중국은행
062 KB증권(현대증권)
063 SK증권
065 교보증권
066 미래에셋증권
067 유안타증권
071 우체국
081 하나비자
083 우리비자
084 유진투자증권
095 저축은행
5.4. 가상계좌 은행 코드
코드 은행명
003 기업
004 국민
011 농협
020 우리
023 SC제일
031 iM 뱅크(대구)
032 부산
037 전북
071 우체국
081 하나
088 신한
5.5. DirectSH 적용 예시
1.DirectSH 적용 시 – 결제창 오픈 시 '신한Pay로 결제하기' 화면이 노출되지 않고 그 다음단계까지 자동 진행
30 / 31

CNSPay Non-PG Module Manual
<PC> <Mobile>
2.DirectSH 미적용 시 – 결제창 오픈 시 '신한Pay로 결제하기' 화면이 노출
<PC> <Mobile>
31 / 31

